# SOME DESCRIPTIVE TITLE.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"Report-Msgid-Bugs-To: http://bugs.kde.org\n"
"POT-Creation-Date: 2017-01-20 18:23+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <kde-i18n-doc@kde.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. Tag: title
#: vt_best_practices.xml:12
#, no-c-format
msgid "Virtualization Best Practices"
msgstr ""

#. Tag: subtitle
#: vt_best_practices.xml:13
#, no-c-format
msgid "&productname; &productnumber;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:32
#, no-c-format
msgid "Virtualization Scenarios"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:34
#, no-c-format
msgid ""
"Virtualization offers a lot of capabilities to your environment. It can be "
"used in multiple scenarios. To get more details about <link xlink:href="
"\"https://www.suse.com/documentation/sles-12/book_virt/data/"
"sec_virtualization_introduction_capabilities.html\">Virtualization "
"Capabilities</link> and <link xlink:href=\"https://www.suse.com/"
"documentation/sles-12/book_virt/data/"
"sec_virtualization_introduction_benefits.html\">Virtualization Benefits</"
"link> please refer to the <link xlink:href=\"https://www.suse.com/"
"documentation/sles-12/book_virt/data/book_virt.html\">Virtualization Guide</"
"link>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:45
#, no-c-format
msgid ""
"This best practice guide will provide advice for making the right choice in "
"your environment. It will recommend or discourage the usage of options "
"depending on your workload. Fixing configuration issue and performing tuning "
"tasks will increase the performance of &vmguest;'s near to bare metal."
msgstr ""

#. Tag: remark
#: vt_best_practices.xml:52
#, no-c-format
msgid ""
"Bruce 20150806: There is no mention of caching considerations, of migration "
"inhibitors, or basic strategies for how to do your storage or networking "
"infrastructure, and only a little bit about how to map your virtualization "
"requirements to host capabilities. I see that the doc doesn't address the "
"issue of when to use Xen PV vs Xen FV vs KVM at all."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:130
#, no-c-format
msgid "Before You Apply Modifications"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:133
#, no-c-format
msgid "Back Up First"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:134
#, no-c-format
msgid ""
"Changing the configuration of the &vmguest; or the &vmhost; can lead to data "
"loss or an unstable state. It is really important that you do backups of "
"files, data, images etc. before making any changes. Without backups you will "
"not be able to easily restore the original state after a data loss or a mis-"
"configuration. Do not perform tests or experiments on production systems."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:145
#, no-c-format
msgid "Test Your Workloads"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:146
#, no-c-format
msgid ""
"The efficiency of a virtualization environment depends on many factors. This "
"guide provides a reference for helping to make good choices when configuring "
"virtualization in a production environment. Nothing is <emphasis>carved in "
"stone</emphasis>. Hardware, workloads, resource capacity, etc. should all be "
"considered when planning, testing, and deploying your virtualization infra-"
"structure. Testing your virtualized workloads is vital to a successful "
"virtualization implementation."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:158
#, no-c-format
msgid "Recommendations"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:160
#, no-c-format
msgid "Prefer the &libvirt; Framework"
msgstr ""

#. Tag: remark
#: vt_best_practices.xml:161
#, no-c-format
msgid ""
"add some explanation about how to enable/disable kvm with qemu-system-arch"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:163
#, no-c-format
msgid ""
"&suse; strongly recommends using the &libvirt; framework to configure, "
"manage, and operate &vmhost;s, containers and &vmguest;. It offers a single "
"interface (GUI and shell) for all supported virtualization technologies and "
"therefore is easier to use than the hypervisor-specific tools."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:169
#, no-c-format
msgid ""
"Using libvirt and hypervisor-specific tools at the same time is not "
"recommended, because changes done with the hypervisor-specific tools may not "
"be recognized by the libvirt toolset. See <link xlink:href=\"https://www."
"suse.com/documentation/sles-12/book_virt/data/cha_libvirt_overview.html\"></"
"link> for more information on libvirt."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:179
#, no-c-format
msgid "qemu-system-i386 Compared to qemu-system-x86_64"
msgstr ""

#. Tag: remark
#: vt_best_practices.xml:180
#, no-c-format
msgid ""
"Lin 20150808: Should we add some explanation about how to enable/disable kvm "
"with qemu-system-arch"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:182
#, no-c-format
msgid ""
"Similar to real 64-bit PC hardware, <command>qemu-system-x86_64</command> "
"supports &vmguest;s running a 32-bit or a 64-bit operating system. Because "
"<command>qemu-system-x86_64</command> usually also provides better "
"performance for 32-bit guests, &suse; generally recomends using "
"<command>qemu-system-x86_64</command> (sceanrios where <command>qemu-system-"
"i386</command> is known to perform better are not supported by &suse;)."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:195
#, no-c-format
msgid "&vmhost; Configuration and Ressource Allocation"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:197
#, no-c-format
msgid ""
"Allocation of resources for &vmguest; is a crucial point when administrating "
"virtual machines. While assigning ressources to &vmguest;, you need to be "
"aware that overcommiting ressources may affect the performance of the "
"&vmhost; and the &vmguest;s. If all &vmguest;s request all their resources "
"simultanesously, the host needs to be able to provide all of them. If not, "
"the host's performance will be negatively affected and this will in turn "
"also have negative effects of the &vmguest;'s performance."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:208
#, no-c-format
msgid "Memory"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:209
#, no-c-format
msgid ""
"Linux manages memory in units called pages. On most systems the default page "
"size is 4 KB. Linux and the CPU need to know which pages belong to which "
"process. That information is stored in a page table. If a lot of processes "
"are running, it takes more time to find where the memory is mapped, due to "
"the time required to search the page table. To speed up the search, the TLB "
"(Translation Lookaside Buffer) was invented. But on a system with a lot of "
"memory the TLB is not enough. To avoid any fallback to normal page table "
"(resulting in a cache miss, which is time consuming), huge pages can be "
"used. Using huge pages will reduce TLB overhead and TLB misses (pagewalk). A "
"host with 32 GB (32*1014*1024 = 33,554,432 KB) of memory and a 4 KB page "
"size has a TLB with: <emphasis>33,554,432/4 = 8,388,608</emphasis> entries. "
"Using a 2 MB (2048 KB) page size, the TLB only has <emphasis>33554432/2048 = "
"16384</emphasis> entries, considerably reducing TLB misses."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:226
#, no-c-format
msgid "Configuring the &vmhost; and the &vmguest; to use Huge Pages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:227
#, no-c-format
msgid ""
"Current CPU architectures support larger pages than 4 KB: huge pages. To "
"determine the size of huge pages available on your system (could be 2 MB or "
"1 GB), check the <literal>flags</literal> line in the output of <filename>/"
"proc/cpuinfo</filename> for occurrences of <literal>pse</literal> and/or "
"<literal>pdpe1gb</literal>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:235
#, no-c-format
msgid "Determine the Available Huge Pages Size"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:242
#, no-c-format
msgid "CPU flag"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:247
#, no-c-format
msgid "Huge pages size available"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:256
#, no-c-format
msgid "Empty string"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:261
#, no-c-format
msgid "No huge pages available"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:268
#, no-c-format
msgid "<para>pse</para>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:273
#, no-c-format
msgid "2 MB"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:280
#, no-c-format
msgid "pdpe1gb"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:285
#, no-c-format
msgid "1 GB"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:293
#, no-c-format
msgid ""
"Using huge pages improves performance of &vmguest; and reduces host memory "
"consumption."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:297
#, no-c-format
msgid ""
"By default the system uses THP, to make huge pages available on your system "
"you need to activate it at boot time with <option>hugepages=1</option>, and, "
"optionally, add the huge pages size with, for example, "
"<option>hugepagesz=2MB</option>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:304
#, no-c-format
msgid "1 GB huge pages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:305
#, no-c-format
msgid ""
"1 GB pages can only be allocated at boot time and cannot be freed afterward."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:310
#, no-c-format
msgid ""
"To allocate and use the huge page table (HugeTlbPage) you need to mount "
"<filename>hugetlbfs</filename> with correct permissions."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:315
#, no-c-format
msgid "Huge Pages: Restrictions"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:316
#, no-c-format
msgid ""
"Even if huge pages provide the best performance, they do come with some "
"drawbacks. You lose features such as Memory ballooning (see <xref linkend="
"\"vt.best.virtio.balloon\"/>), KSM (see <xref linkend=\"vt.best.perf.ksm\"/"
">, and huge pages cannot be swapped."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:324
#, no-c-format
msgid "Configuring the use of huge pages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:326
#, no-c-format
msgid ""
"Mount <literal>hugetlbfs</literal> to <filename>/dev/hugepages</filename>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:330
#, no-c-format
msgid "# mount -t hugetlbfs hugetlbfs /dev/hugepages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:333
#, no-c-format
msgid ""
"To reserve memory for huge pages use the <command>sysctl</command>. If your "
"system has a huge page size of 2 MB (2048 KB), and you want to reserve 1 GB "
"(1,048,576 KB) for your &vmguest;, you need <emphasis>1,048,576/2048=512</"
"emphasis> pages in the pool:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:339
#, no-c-format
msgid "# sysctl vm.nr_hugepages=512"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:340
#, no-c-format
msgid ""
"The value is written to <filename>/proc/sys/vm/nr_hugepages</filename> and "
"represents the current number of <emphasis>persistent</emphasis> huge pages "
"in the kernel's huge page pool. <emphasis>Persistent</emphasis> huge pages "
"will be returned to the huge page pool when freed by a task."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:349
#, no-c-format
msgid ""
"Add the <emphasis>memoryBacking</emphasis> element in the &vmguest; "
"configuration file (by running <command>virsh edit "
"<replaceable>CONFIGURATION</replaceable></command>)."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:354
#, no-c-format
msgid ""
"&lt;memoryBacking&gt;\n"
"  &lt;hugepages/&gt;\n"
"&lt;/memoryBacking&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:357
#, no-c-format
msgid "Start your &vmguest; and check on the host whether it uses hugepages:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:360
#, no-c-format
msgid ""
"# cat /proc/meminfo | grep HugePages_\n"
"HugePages_Total:<co xml:id=\"co.hp.total\"/>    512\n"
"HugePages_Free:<co xml:id=\"co.hp.free\"/>       92\n"
"HugePages_Rsvd:<co xml:id=\"co.hp.rsvd\"/>        0\n"
"HugePages_Surp:<co xml:id=\"co.hp.surp\"/>        0"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:363
#, no-c-format
msgid "Size of the pool of huge pages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:368
#, no-c-format
msgid "Number of huge pages in the pool that are not yet allocated"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:373
#, no-c-format
msgid ""
"Number of huge pages for which a commitment to allocate from the pool has "
"been made, but no allocation has yet been made"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:379
#, no-c-format
msgid ""
"Number of huge pages in the pool above the value in <filename>/proc/sys/vm/"
"nr_hugepages</filename>. The maximum number of surplus huge pages is "
"controlled by <filename>/proc/sys/vm/nr_overcommit_hugepages</filename>"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:391
#, no-c-format
msgid "Transparent Huge Pages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:392
#, no-c-format
msgid ""
"Transparent huge pages (THP) provide a way to dynamically allocate huge "
"pages with the <command>khugepaged</command> kernel thread, rather than "
"manually managing their allocation and use. Workloads with contiguous memory "
"access patterns can benefit greatly from THP. A 1000 fold decrease in page "
"faults can be observed when running synthetic workloads with contiguous "
"memory access patterns. Conversely, workloads with sparse memory access "
"patterns (like databases) may perform poorly with THP. In such cases it may "
"be preferable to disable THP by adding the kernel parameter "
"<option>transparent_hugepage=never</option>, rebuild your grub2 "
"configuration, and reboot. Verify if THP is disabled with:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:405
#, no-c-format
msgid ""
"&prompt.root;cat /sys/kernel/mm/transparent_hugepage/enabled\n"
"always madvise [never]"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:406
#, no-c-format
msgid ""
"If disabled, the value <literal>never</literal> is shown in square brackets "
"like in the example above."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:411
#, no-c-format
msgid "&xen;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:412
#, no-c-format
msgid "THP is not available under &xen;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:418
#, no-c-format
msgid "&xen;-specific Memory Notes"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:420
#, no-c-format
msgid "Managing Domain-0 Memory"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:421
#, no-c-format
msgid ""
"When using the &xen; hypervisor, by default a small percentage of system "
"memory is reserved for the hypervisor, with all remaining memory "
"automatically allocated to Domain-0. When virtual machines are created, "
"memory is ballooned out of Domain-0 to provide memory for the virtual "
"machine. This process is called \"autoballooning\"."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:428
#, no-c-format
msgid "Autoballooning has several limitations:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:433
#, no-c-format
msgid ""
"Reduced performance while dom0 is ballooning down to free memory for the new "
"domain."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:439
#, no-c-format
msgid ""
"Memory freed by ballooning is not confined to a specific NUMA node. This can "
"result in performance problems in the new domain due to using a non-optimal "
"NUMA configuration."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:446
#, no-c-format
msgid ""
"Failure to start large domains due to delays while ballooning large amounts "
"of memory from dom0."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:452
#, no-c-format
msgid ""
"For these reasons, it is strongly recommended to disable autoballooning and "
"give Domain-0 a predefined amount of memory."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:456
#, no-c-format
msgid ""
"Autoballooning is controlled by the toolstack used to manage your &xen; "
"installation. For the xl/libxl toolstack, autoballooning is controlled by "
"the <option>autoballoon</option> setting in <filename>/etc/xen/xl.conf</"
"filename>. For the libvirt+libxl toolstack, autoballooning is controlled by "
"the <option>autoballoon</option> setting in <filename>/etc/libvirt/libxl."
"conf</filename>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:465
#, no-c-format
msgid ""
"The amount of memory initially allocated to Domain-0 is controlled by the "
"&xen; hypervisor dom0_mem parameter. For example, to set the memory of "
"Domain-0 to 8GB, add <option>dom0_mem=8G</option> to the &xen; hypervisor "
"parameters."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:473
#, no-c-format
msgid ""
"To set dom0_mem on SLE11 products, modify <filename>/boot/grub/menu.lst</"
"filename>, adding <option>dom0_mem=XX</option> to the &xen; hypervisor (xen."
"gz) parameters. The change will be applied at next reboot."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:481
#, no-c-format
msgid ""
"To set dom0_mem on SLE12 products, modify <filename>/etc/default/grub</"
"filename>, adding <option>dom0_mem=XX</option> to "
"<option>GRUB_CMDLINE_XEN_DEFAULT</option>. See <xref linkend=\"vt.best."
"kernel.parameter\"/> for more information."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:490
#, no-c-format
msgid ""
"Autoballooning is enabled by default since it is extremely difficult to "
"determine a predefined amount of memory required by Domain-0. Memory needed "
"by Domain-0 is heavily dependent on the number of hosted virtual machines "
"and their configuration. Users must ensure Domain-0 has sufficient memory "
"resources to accommodate virtual machine workloads."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:500
#, no-c-format
msgid "xenstore in <systemitem>tmpfs</systemitem>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:501
#, no-c-format
msgid ""
"When using &xen;, it is recommended to place the xenstore database on "
"<systemitem>tmpfs</systemitem>. xenstore is used as a control plane by the "
"xm/xend and xl/libxl toolstacks and the frontend and backend drivers "
"servicing domain I/O devices. The load on xenstore increases linearly as the "
"number of running domains increase. If you anticipate hosting many &vmguest; "
"on a &xen; host, move the xenstore database onto tmpfs to improve overall "
"performance of the control plane. Mount the <filename>/var/lib/xenstored</"
"filename> directory on tmpfs:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:511
#, no-c-format
msgid "# mount -t tmpfs tmpfs /var/lib/xenstored/"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:515
#, no-c-format
msgid "KSM and Page Sharing"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:516
#, no-c-format
msgid ""
"Kernel Samepage Merging is a kernel feature that allows for lesser memory "
"consumption on the &vmhost; by sharing data &vmguest;s have in common. The "
"KSM daemon <systemitem class=\"daemon\">ksmd</systemitem> periodically scans "
"user memory looking for pages of identical content which can be replaced by "
"a single write-protected page. To enable KSM run:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:523
#, no-c-format
msgid "echo 1 &gt; /sys/kernel/mm/ksm/run"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:524
#, no-c-format
msgid ""
"One advantage of using KSM from a &vmguest; perspective is that all guest "
"memory is backed by host anonymous memory, so you can share "
"<emphasis>pagecache</emphasis>, <emphasis>tmpfs</emphasis> or any kind of "
"memory allocated in the guest."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:530
#, no-c-format
msgid ""
"KSM is controlled by <systemitem>sysfs</systemitem>. You can check KSM's "
"values in <filename>/sys/kernel/mm/ksm/</filename>:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:536
#, no-c-format
msgid ""
"<literal>pages_shared</literal>: The number of shared pages that are being "
"used (read only)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:542
#, no-c-format
msgid ""
"<literal>pages_sharing</literal>: The number of sites sharing the pages "
"(read only)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:548
#, no-c-format
msgid ""
"<literal>pages_unshared</literal>: The number of pages that are unique and "
"repeatedly checked for merging (read only)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:554
#, no-c-format
msgid ""
"<literal>pages_volatile</literal>: The number of pages that are changing too "
"fast to be considered for merging (read only)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:560
#, no-c-format
msgid ""
"<literal>full_scans</literal>: The number of times all mergeable areas have "
"been scanned (read only)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:566
#, no-c-format
msgid ""
"<literal>sleep_millisecs</literal>: The number of milliseconds <systemitem "
"class=\"daemon\">ksmd</systemitem> should sleep before the next scan. A low "
"value will overuse the CPU, consuming CPU time that could be used for other "
"tasks. A value greater than <literal>1000</literal> is recommended."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:575
#, no-c-format
msgid ""
"<literal>pages_to_scan</literal>: The number of present pages to scan before "
"ksmd goes to sleep. A high value will overuse the CPU. It is recommended to "
"start with a value of <literal>1000</literal>, and then adjust as necessary "
"based on the KSM results observed while testing your deployment."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:584
#, no-c-format
msgid ""
"<literal>merge_across_nodes</literal>: by default the system merges pages "
"across NUMA nodes. Set this option to <literal>0</literal> to disable this "
"behavior."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:592
#, no-c-format
msgid "Usecases"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:593
#, no-c-format
msgid ""
"KSM is a good technique to over-commit host memory when running multiple "
"instances of the same application or &vmguest;. When applications and "
"&vmguest; are heterogeneous and do not share any common data, it is "
"preferable to disable KSM. In a mixed heterogeneous and homogeneous "
"environment, KSM can be enabled on the host but disabled on a per &vmguest; "
"basis. Use <command>virsh edit</command> to disable page sharing of a "
"&vmguest; by adding the following to the guest's XML configuration:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:603
#, no-c-format
msgid ""
"&lt;memoryBacking&gt;\n"
"   &lt;nosharepages/&gt;\n"
"&lt;/memoryBacking&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:606
#, no-c-format
msgid "Avoid Out-Of-Memory Conditions"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:607
#, no-c-format
msgid ""
"KSM can free up some memory on the host system, but the administrator should "
"also reserve enough swap to avoid out-of-memory conditions in the event "
"sharable memory decreases. A decrease in the amount of sharable memory "
"results in an increase in the use of physical memory."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:615
#, no-c-format
msgid "Memory Access Latencies"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:616
#, no-c-format
msgid ""
"By default, KSM will merge common pages across NUMA nodes. This may degrade "
"&vmguest; performance if the merged, common page is now located on a distant "
"NUMA node, relative to the node running the &vmguest; VCPUs. If increased "
"memory access latencies are noticed in the &vmguest;, disable cross-node "
"merging with the <emphasis>merge_across_nodes</emphasis> sysfs control:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:624
#, no-c-format
msgid "echo 0 &gt; /sys/kernel/mm/ksm/merge_across_nodes"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:628
#, no-c-format
msgid "&vmguest;: Memory Hotplug"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:629
#, no-c-format
msgid ""
"To optimize the usage of your host memory, it may be useful to hot plug more "
"memory for a running &vmguest; when required. To support memory hot-"
"plugging, you must first configure the <emphasis>&lt;maxMemory&gt;</"
"emphasis> tag in the &vmguest;'s configuration file:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:636
#, no-c-format
msgid ""
"&lt;maxMemory<co xml:id=\"co.mem.hot.max\"/> slots='16'<co xml:id=\"co.mem."
"hot.slots\"/> unit='KiB'&gt;20971520<co xml:id=\"co.mem.hot.size\"/>&lt;/"
"maxMemory&gt;\n"
"  &lt;memory<co xml:id=\"co.mem.hot.mem\"/> unit='KiB'&gt;1048576&lt;/"
"memory&gt;\n"
"&lt;currentMemory<co xml:id=\"co.mem.hot.curr\"/> unit='KiB'&gt;1048576&lt;/"
"currentMemory&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:639
#, no-c-format
msgid "Run time maximum memory allocation of the guest."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:644
#, no-c-format
msgid "Number of slots available for adding memory to the guest"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:649
#, no-c-format
msgid "Valid units are:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:654
#, no-c-format
msgid "\"KB\" for kilobytes (1,000 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:659
#, no-c-format
msgid "\"k\" or \"KiB\" for kibibytes (1,024 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:664
#, no-c-format
msgid "\"MB\" for megabytes (1,000,000 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:669
#, no-c-format
msgid "\"M\" or \"MiB\" for mebibytes (1,048,576 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:674
#, no-c-format
msgid "\"GB\" for gigabytes (1,000,000,000 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:679
#, no-c-format
msgid "\"G\" or \"GiB\" for gibibytes (1,073,741,824 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:684
#, no-c-format
msgid "\"TB\" for terabytes (1,000,000,000,000 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:689
#, no-c-format
msgid "\"T\" or \"TiB\" for tebibytes (1,099,511,627,776 bytes)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:696
#, no-c-format
msgid "Maximum allocation of memory for the guest at boot time"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:701
#, no-c-format
msgid "Actual allocation of memory for the guest"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:706
#, no-c-format
msgid ""
"To hot plug memory devices into the slots, create a file <filename>mem-dev."
"xml</filename> like the following:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:710
#, no-c-format
msgid ""
"&lt;memory model='dimm'&gt;\n"
"  &lt;target&gt;\n"
"  &lt;size unit='KiB'>524287&lt;/size&gt;\n"
"  &lt;node>0&lt;/node&gt;\n"
"  &lt;/target&gt;\n"
"&lt;/memory&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:711
#, no-c-format
msgid "And attach it with the following command:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:714
#, no-c-format
msgid "virsh attach-device vm-name mem-dev.xml"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:715
#, no-c-format
msgid ""
"For memory device hotplug, the guest must have at least 1 NUMA cell defined "
"(see <xref linkend=\"vt.best.perf.numa.vmguest.topo\"/>)."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:723
#, no-c-format
msgid "Swap"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:724
#, no-c-format
msgid ""
"<emphasis>Swap</emphasis> is usually used by the system to store underused "
"physical memory (low usage, or not accessed for a long time). To prevent the "
"system running out of memory, setting up a minimum swap is highly "
"recommended."
msgstr ""

#. Tag: literal
#: vt_best_practices.xml:731
#, no-c-format
msgid "swappiness"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:732
#, no-c-format
msgid ""
"The <literal>swappiness</literal> setting controls your system's swap "
"behavior. It defines how memory pages are swapped to disk. A high value of "
"<emphasis>swappiness</emphasis> results in a system that swaps more often. "
"Available values range from <literal>0</literal> to <literal>100</literal>. "
"A value of <literal>100</literal>> tells the system to find inactive pages "
"and put them in swap. A value of <option>0</option> disables swapping."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:744
#, no-c-format
msgid ""
"To change the value and do some testing on a live system, change the value "
"of <filename>/proc/sys/vm/swappiness</filename> on the fly and check the "
"memory usage afterwards:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:749
#, no-c-format
msgid "&prompt.root;echo 35 &gt; /proc/sys/vm/swappiness"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:750
#, no-c-format
msgid ""
"&prompt.root;free -h\n"
"total       used       free     shared    buffers     cached\n"
"Mem:      24616680    4991492   19625188     167056     144340    2152408\n"
"-/+ buffers/cache:    2694744   21921936\n"
"Swap:      6171644          0    6171644"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:751
#, no-c-format
msgid ""
"To permanently set a swapiness value, add a line in <filename>/etc/systcl."
"conf</filename>, for example:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:755
#, no-c-format
msgid "vm.swappiness = 35"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:756
#, no-c-format
msgid ""
"You can also control the swap by using the <emphasis>swap_hard_limit</"
"emphasis> element in the XML configuration of your &vmguest;. It is highly "
"recommended to do some testing before setting this parameter and using it in "
"a production environment, because the host can kill the domain if the value "
"is too low."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:763
#, no-c-format
msgid ""
"&lt;memtune&gt;<co xml:id=\"co.mem.1\"/>\n"
"  &lt;hard_limit unit='G'&gt;1&lt;/hard_limit&gt;<co xml:id=\"co.mem.hard\"/"
">\n"
"  &lt;soft_limit unit='M'&gt;128&lt;/soft_limit&gt;<co xml:id=\"co.mem.soft"
"\"/>\n"
"  &lt;swap_hard_limit unit='G'&gt;2&lt;/swap_hard_limit&gt;<co xml:id=\"co."
"mem.swap\"/>\n"
"&lt;/memtune&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:766
#, no-c-format
msgid ""
"This element provides memory tunable parameters for the domain. If this is "
"omitted, it defaults to the defaults provided b ythe operating system."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:773
#, no-c-format
msgid ""
"Maximum memory the guest can use. To avoid any problems on the &vmguest; it "
"is strongly recommended to do not use this parameter."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:779
#, no-c-format
msgid "The memory limit to enforce during memory contention."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:784
#, no-c-format
msgid "The maximum memory plus swap the &vmguest; can use."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:793
#, no-c-format
msgid "<title>I/O</title>"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:796
#, no-c-format
msgid "I/O Scheduler"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:797
#, no-c-format
msgid ""
"The default I/O scheduler is Completely Fair Queuing (CFQ). The main aim of "
"the CFQ scheduler is to provide a fair allocation of the disk I/O bandwidth "
"for all processes that request an I/O operation. You can have different I/O "
"schedulers for different devices."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:803
#, no-c-format
msgid ""
"To get better performance in host and &vmguest; it is recommended to use "
"<emphasis>noop</emphasis> in the &vmguest; (disable the I/O scheduler) and "
"the <emphasis>deadline</emphasis> scheduler for a virtualization host."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:810
#, no-c-format
msgid "Checking and Changing the I/O Scheduler at Runtime"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:812
#, no-c-format
msgid ""
"To check your current I/O scheduler for your disk (replace <replaceable>sdX</"
"replaceable> by the disk you want to check), run:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:816
#, no-c-format
msgid ""
"# cat /sys/block/<replaceable>sdX</replaceable>/queue/scheduler\n"
"noop deadline [cfq]"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:817
#, no-c-format
msgid ""
"The value in square brackets is the one currently selected (<literal>cfq</"
"literal> in the example above)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:823
#, no-c-format
msgid "You can change the scheduler at runtime with the following command:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:826
#, no-c-format
msgid ""
"echo deadline &gt; /sys/block/<replaceable>sdX</replaceable>/queue/scheduler"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:830
#, no-c-format
msgid ""
"To permanently set an I/O scheduler for all disks of a system, use the "
"Kernel parameter <literal>elevator</literal>. the respective values are "
"<option>elevator=deadline</option> for the &vmhost; and "
"<option>elevator=noop</option> for &vmguest;s. See <xref linkend=\"vt.best."
"kernel.parameter\"/> for further instructions."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:837
#, no-c-format
msgid ""
"If you need to specify different I/O schedulers for each disk create the "
"file <filename>/usr/lib/tmpfiles.d/IO_ioscheduler.conf</filename> with a "
"content similar to the following example, which defines the "
"<literal>deadline</literal> scheduler for <filename>/dev/sda</filename> and "
"the <literal>noop</literal> scheduler for <filename>/dev/sdb</filename>. "
"This feature is available on &slea; 12 only."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:846
#, no-c-format
msgid ""
"w /sys/block/sda/queue/scheduler - - - - deadline\n"
"w /sys/block/sdb/queue/scheduler - - - - noop"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:849
#, no-c-format
msgid "I/O Virtualization"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:850
#, no-c-format
msgid ""
"SUSE products support various I/O Virtualization technologies. The following "
"table lists advantages and disadvantages of each technology. For more "
"information about I/O in virtualization refer to the <link xlink:href="
"\"https://www.suse.com/documentation/sles-12/book_virt/data/sec_vt_io.html"
"\">I/O in Virtualization</link> chapter in the <citetitle>&productname; "
"&productnumber; Virtualization Guide</citetitle>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:860
#, no-c-format
msgid "I/O Virtualization Solutions"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:868 vt_best_practices.xml:1024
#, no-c-format
msgid "Technology"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:873
#, no-c-format
msgid "Advantage"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:878
#, no-c-format
msgid "Disadvantage"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:887
#, no-c-format
msgid "Device Assignment (pass-through)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:893
#, no-c-format
msgid "Device accessed directly by the guest"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:898
#, no-c-format
msgid "No sharing among multiple guests"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:905
#, no-c-format
msgid "High performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:910 vt_best_practices.xml:1069
#, no-c-format
msgid "Live migration is complex"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:920
#, no-c-format
msgid "PCI device limit is 8 per guest"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:930
#, no-c-format
msgid "Limited number of slots on a server"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:937
#, no-c-format
msgid "Full virtualization (IDE, SATA, SCSI, e1000)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:943
#, no-c-format
msgid "&vmguest; compatibility"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:948
#, no-c-format
msgid "Bad performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:955 vt_best_practices.xml:985
#, no-c-format
msgid "Easy for live migration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:960
#, no-c-format
msgid "Emulated operation"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:967
#, no-c-format
msgid "Para-virtualization (virtio-blk, virtio-net, virtio-scsi)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:973
#, no-c-format
msgid "Good performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:978
#, no-c-format
msgid "Modified guest (PV drivers)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:995
#, no-c-format
msgid "Efficient host communication with &vmguest;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1010
#, no-c-format
msgid "Storage and File System"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1011
#, no-c-format
msgid ""
"Storage space for &vmguest;s can either be a block device (for example a "
"partition on a physical disk), or an image file on the file system:"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1016
#, no-c-format
msgid "Block Devices Compared to Disk Images"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1029
#, no-c-format
msgid "Advantages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1034
#, no-c-format
msgid "Disadvantages"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1043
#, no-c-format
msgid "Block devices"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1050
#, no-c-format
msgid "Better performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1055
#, no-c-format
msgid "Use standard tools for administration/disk modification"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1060
#, no-c-format
msgid "Accessible from host (pro and con)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1074
#, no-c-format
msgid "Impossible to increase capacity"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1083
#, no-c-format
msgid "Image files"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1090
#, no-c-format
msgid "Easier system management"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1095
#, no-c-format
msgid "Easily move, clone, expand, back up domains"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1100
#, no-c-format
msgid "Comprehensive toolkit (guestfs) for image manipulation"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1105
#, no-c-format
msgid "Reduce overhead through sparse files"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1110
#, no-c-format
msgid "Fully allocate for best performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1119
#, no-c-format
msgid "Less performance than block devices"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1147
#, no-c-format
msgid ""
"For detailed information about image formats and maintaining images refer to "
"<xref linkend=\"vt.best.img\"/>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1152
#, no-c-format
msgid ""
"If your image is stored on an NFS share, you should check some server and "
"client parameters to improve access to the &vmguest; image."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1157
#, no-c-format
msgid "NFS Read/Write (Client)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1158
#, no-c-format
msgid ""
"Options <option>rsize</option> and <option>wsize</option> specify the size "
"of the chunks of data that the client and server pass back and forth to each "
"other. You should ensure NFS read/write sizes are sufficiently large, "
"especially for large I/O. Change the <option>rsize</option> and "
"<option>wsize</option> parameter in your <filename>/etc/fstab</filename> by "
"increasing the value to 16 KB, which will ensure that all operations can be "
"frozen if there is any instance of hanging."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1167
#, no-c-format
msgid ""
"nfs_server:/exported/vm_images<co xml:id=\"co.nfs.server\"/> /mnt/images<co "
"xml:id=\"co.nfs.mnt\"/> nfs<co xml:id=\"co.nfs.nfs\"/> rw<co xml:id=\"co.nfs."
"rw\"/>,hard<co xml:id=\"co.nfs.hard\"/>,sync<co xml:id=\"co.nfs.sync\"/>, "
"rsize=8192<co xml:id=\"co.nfs.rsize\"/>,wsize=8192<co xml:id=\"co.nfs.wsize"
"\"/> 0 0"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1170
#, no-c-format
msgid "NFS server's host name and export path name"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1175
#, no-c-format
msgid "Where to mount the NFS exported share"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1180
#, no-c-format
msgid "This is an <option>nfs</option> mount point"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1185
#, no-c-format
msgid "This mount point will be accessible in read/write"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1190
#, no-c-format
msgid ""
"Determines the recovery behavior of the NFS client after an NFS request "
"times out. <option>hard</option> is the best option to avoid data corruption"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1197
#, no-c-format
msgid ""
"Any system call that writes data to files on that mount point causes that "
"data to be flushed to the server before the system call returns control to "
"user space"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1204
#, no-c-format
msgid ""
"Maximum number of bytes in each network READ request that the NFS client can "
"receive when reading data from a file on an NFS server"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1210
#, no-c-format
msgid ""
"Maximum number of bytes per network WRITE request that the NFS client can "
"send when writing data to a file on an NFS server."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1218
#, no-c-format
msgid "NFS Threads (Server)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1219
#, no-c-format
msgid ""
"Your NFS server should have enough NFS threads to handle multi-threaded "
"workloads. Use the <command>nfsstat</command> tool to get some RPC "
"statistics on your server:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1224
#, no-c-format
msgid ""
"# nfsstat -rc\n"
"Client rpc stats:\n"
"calls      retrans    authrefrsh\n"
"6401066    198          0          0"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1225
#, no-c-format
msgid ""
"If the <emphasis>retrans</emphasis> is equal to 0 everything is fine. "
"Otherwise, the client needs to retransmit, so increase the "
"<emphasis>USE_KERNEL_NFSD_NUMBER</emphasis> variable in <filename>/etc/"
"sysconfig/nfs</filename>, and adjust accordingly until <emphasis>retrans</"
"emphasis> is equal to <emphasis>0</emphasis>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1236
#, no-c-format
msgid "CPUs"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1237
#, no-c-format
msgid ""
"Host CPU <quote>components</quote> will be <quote>translated</quote> to "
"virtual CPUs in a &vmguest; when being assigned. These components can either "
"be:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1244
#, no-c-format
msgid ""
"<emphasis>CPU processor</emphasis>: this describes the main CPU unit, which "
"usually has multiple cores and may support Hyper-Threading."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1250
#, no-c-format
msgid ""
"<emphasis>CPU core</emphasis>: a main CPU unit can provide more than one "
"core, and the proximity of cores speeds up the computation process and "
"reduces energy costs."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1257
#, no-c-format
msgid ""
"<emphasis>CPU Hyper-Threading</emphasis>: this implementation is used to "
"improve parallelization of computations, but this is not as efficient as a "
"dedicated core."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1266
#, no-c-format
msgid "Assigning CPUs"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1267
#, no-c-format
msgid ""
"You should avoid overcommitting CPUs. Unless you know exactly how many "
"virtual CPUs are required for a &vmguest;, you should start with a sengle "
"virtual CPU per &vmguest;. Each virtual CPU should match one hardware "
"processor or core on the &vmhost;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1273
#, no-c-format
msgid ""
"You should target a CPU workload of approximately 70% inside your VM (see "
"<link xlink:href=\"https://www.suse.com/documentation/sles-12/"
"book_sle_tuning/data/sec_util_processes.html\"></link> for information on "
"monitoring tools). If you allocate more processors than needed in the "
"&vmguest;, this will negatively affect the performance of host and guest: "
"cycle efficiency will be degraded, the unused vCPU will consume timer "
"interrupts and will idle loop. In case you primarily run single threaded "
"applications on a &vmguest;, a single virtual CPU is the best choice."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1284
#, no-c-format
msgid "&vmguest; CPU Configuration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1285
#, no-c-format
msgid ""
"This section describes how to choose and configure a CPU type for a "
"&vmguest;. You will also learn how to pin virtual CPUs to physical CPUs on "
"the host system. For more information about virtual CPU configuration and "
"tuning parameters refer to the libvirt documentation at <link xlink:href="
"\"https://libvirt.org/formatdomain.html#elementsCPU\"></link>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1292
#, no-c-format
msgid "Virtual CPU Models and Features"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1293
#, no-c-format
msgid ""
"The CPU model and topology can be specified individually for each &vmguest;. "
"Configuration options range from selecting specific CPU models to excluding "
"certain CPU features. Predefined CPU models are listed in the <filename>/usr/"
"share/libvirt/cpu_map.xml</filename>. Multiple sockets with a single core "
"and a single thread generally provide the best performance. The list of "
"available CPUs and topologies depends on the host system and can be "
"displayed by running <command>virsh capabilities</command>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1303
#, no-c-format
msgid ""
"Note that changing the default virtual CPU configuration will require a "
"&vmguest; shutdown when migrating it to a host with a host with different "
"hardware. More information on &vmguest; migration is available at <link "
"xlink:href=\"https://www.suse.com/documentation/sles-12/book_virt/data/"
"sec_libvirt_admin_migrate.html\"></link>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1308
#, no-c-format
msgid ""
"To specify a particular CPU model for a &vmguest;, add a respective entry to "
"the &vmguest; configuration file. The following example configures a "
"Broadwell CPU with the invariant TSC feature:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1313
#, no-c-format
msgid ""
"&lt;cpu mode='custom' match='exact'&gt;\n"
"  &lt;model&gt;Broadwell&lt;/model&gt;\n"
"  &lt;feature name='invtsc'/&gt;\n"
"&lt;/cpu&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1315
#, no-c-format
msgid "The <literal>host-passthrough</literal> Mode"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1316
#, no-c-format
msgid ""
"With &lt;cpu mode='host-passthrough'&gt; the virtual CPU will be exactly the "
"same as the host CPU. Using this method makes it impossible to reproduced "
"the &vmguest; on different hardware."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1324
#, no-c-format
msgid "Virtual CPU Pinning"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1325
#, no-c-format
msgid ""
"Virtual CPU pinning is used to constrain vCPU threads to a set of physical "
"CPUs. The <literal>vcpupin</literal> element specifies to which physical "
"host CPU a virtual CPU will be pinned to. If this element is not set and the "
"attribute <emphasis>cpuset</emphasis> of the element <emphasis>vcpu</"
"emphasis> is not specified, the virtual CPU is pinned to all the physical "
"CPUs by default."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1333
#, no-c-format
msgid ""
"CPU intensive workloads can benefit from virtual CPU pinning by increasing "
"the physical CPU cache hit ratio. To pin a vCPU to a specific CPU run the "
"following commands:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1338
#, no-c-format
msgid ""
"&prompt.root;virsh vcpupin <replaceable>DOMAIN_ID</replaceable> --vcpu "
"<replaceable>vCPU_NUMBER</replaceable>\n"
"VCPU: CPU Affinity\n"
"----------------------------------\n"
"0: 0-7\n"
"&prompt.root;virsh vcpupin SLE12 --vcpu 0 0 --config"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1339
#, no-c-format
msgid ""
"The last command generates the following entry in the XML configuration:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1342
#, no-c-format
msgid ""
"&lt;cputune&gt;\n"
"   &lt;vcpupin vcpu='0' cpuset='0'/&gt;\n"
"&lt;/cputune&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1344
#, no-c-format
msgid "Virtual CPU pinning on NUMA Nodes"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1345
#, no-c-format
msgid ""
"On a NUMA system, virtual CPU pinning and memory allocation policies can be "
"used to ensure a &vmguest;'s CPUs and its memory are confined to a NUMA "
"node. See <xref linkend=\"vt.best.perf.numa\"/> for more information related "
"to NUMA tuning."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1353
#, no-c-format
msgid "Virtual CPU pinning and Live Migration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1354
#, no-c-format
msgid ""
"Even though <literal>vcpupin</literal> can improve performance, you should "
"take into consideration that live migration of a pinned &vmguest; can be "
"problematic. If, for example, the requested physical resources are not be "
"available on the destination host, or the source and destination hosts have "
"different NUMA topologies, the migration will fail. For more recommendations "
"about Live Migration see <link xlink:href=\"https://www.suse.com/"
"documentation/sles-12/book_virt/data/sec_libvirt_admin_migrate."
"html#libvirt_admin_live_migration_requirements\">Virtualization Live "
"Migration Requirements</link>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1370
#, no-c-format
msgid "NUMA Tuning"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1371
#, no-c-format
msgid ""
"NUMA is an acronym for Non Uniform Memory Access. A NUMA system has multiple "
"physical CPUs, each with local memory attached. Each CPU can also access "
"other CPUs' memory, known as <quote>remote memory access</quote>, but it is "
"much slower than accessing local memory. NUMA systems can negatively impact "
"&vmguest; performance if not tuned properly. Although ultimately tuning is "
"workload dependent, this section describes controls that should be "
"considered when deploying &vmguest;s on NUMA hosts. Always consider your "
"host topology when configuring and deploying VMs."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1381
#, no-c-format
msgid ""
"&productname; contains a NUMA auto-balancer that strives to reduce remote "
"memory access by placing memory on the same NUMA node as the CPU processing "
"it. In addition, standard tools such as <command>cgset</command> and "
"virtualization tools such as libvirt provide mechanisms to constrain "
"&vmguest; resources to physical resources."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1388
#, no-c-format
msgid "<command>numactl</command> is used to check for host NUMA capabilities:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1391
#, no-c-format
msgid ""
"&prompt.root;numactl --hardware\n"
"available: 4 nodes (0-3)\n"
"node 0 cpus: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 72 73 74 75 76 77 "
"78\n"
"79 80 81 82 83 84 85 86 87 88 89\n"
"node 0 size: 31975 MB\n"
"node 0 free: 31120 MB\n"
"node 1 cpus: 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 90 91 92 "
"93\n"
"94 95 96 97 98 99 100 101 102 103 104 105 106 107\n"
"node 1 size: 32316 MB\n"
"node 1 free: 31673 MB\n"
"node 2 cpus: 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 108 109 "
"110\n"
"111 112 113 114 115 116 117 118 119 120 121 122 123 124 125\n"
"node 2 size: 32316 MB\n"
"node 2 free: 31726 MB\n"
"node 3 cpus: 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 126 127 "
"128\n"
"129 130 131 132 133 134 135 136 137 138 139 140 141 142 143\n"
"node 3 size: 32314 MB\n"
"node 3 free: 31387 MB\n"
"node distances:\n"
"node   0   1   2   3\n"
"0:  10  21  21  21\n"
"1:  21  10  21  21\n"
"2:  21  21  10  21\n"
"3:  21  21  21  10"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1392
#, no-c-format
msgid ""
"The <command>numactl</command> output shows this is a NUMA system with 4 "
"nodes or cells, each containing 36 CPUs and approximately 32G memory. "
"<command>virsh capabilities</command> can also be used to examine the "
"systems NUMA capabilities and CPU topoloy."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1399
#, no-c-format
msgid "NUMA Balancing"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1400
#, no-c-format
msgid ""
"On NUMA machines, there is a performance penalty if remote memory is "
"accessed by a CPU. Automatic NUMA balancing scans a task's address space and "
"unmaps pages to detect whether pages are properly placed or whether the data "
"should be migrated to a memory node local to where the task is running. In "
"defined intervals (configured with <literal>numa_balancing_scan_delay_ms</"
"literal>), the task scans the next scan size number of pages (configured "
"with <literal>numa_balancing_scan_size_mb</literal>) in its address space. "
"When the end of the address space is reached the scanner restarts from the "
"beginning."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1412
#, no-c-format
msgid ""
"Higher scan rates cause higher system overhead as page faults must be "
"trapped and data needs to be migrated. However, the higher the scan rate, "
"the more quickly a task's memory is migrated to a local node when the "
"workload pattern changes. This minimizes the performance impact due to "
"remote memory accesses. These <command>sysctl</command> directives control "
"the thresholds for scan delays and the number of pages scanned:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1420
#, no-c-format
msgid ""
"# sysctl -a | grep numa_balancing\n"
"kernel.numa_balancing = 1<co xml:id=\"co.numa.balancing\"/>\n"
"kernel.numa_balancing_scan_delay_ms = 1000<co xml:id=\"co.numa.delay\"/>\n"
"kernel.numa_balancing_scan_period_max_ms = 60000<co xml:id=\"co.numa.pmax\"/"
">\n"
"kernel.numa_balancing_scan_period_min_ms = 1000<co xml:id=\"co.numa.pmin\"/"
">\n"
"kernel.numa_balancing_scan_size_mb = 256<co xml:id=\"co.numa.size\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1423
#, no-c-format
msgid "Enables/disables automatic page fault-based NUMA balancing"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1428
#, no-c-format
msgid "Starting scan delay used for a task when it initially forks"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1433
#, no-c-format
msgid "Maximum time in milliseconds to scan a task's virtual memory"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1438
#, no-c-format
msgid "Minimum time in milliseconds to scan a task's virtual memory"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1443
#, no-c-format
msgid "Size in megabytes worth of pages to be scanned for a given scan"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1448
#, no-c-format
msgid ""
"For more information see <link xlink:href=\"https://www.suse.com/"
"documentation/sles-12/book_sle_tuning/data/cha_tuning_numactl.html\"></link>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1451
#, no-c-format
msgid ""
"The main goal of automatic NUMA balancing is either to reschedule tasks on "
"the same node's memory, so the CPU follows the memory, or to copy the "
"memory's pages to the same node, so the memory follows the CPU."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1457
#, no-c-format
msgid "Task Placement"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1458
#, no-c-format
msgid ""
"There are no rules to define the best place to run a task, because tasks "
"could share memory with other tasks. For best performance, it is recommended "
"to group tasks sharing memory on the same node. Check NUMA statistics with "
"<command># cat /proc/vmstat | grep numa_</command>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1467
#, no-c-format
msgid "Memory Allocation control with the CPUset Controller"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1468
#, no-c-format
msgid ""
"The cgroups cpuset controller can be used confine memory used by a process "
"to a NUMA node. There are three cpuset memory policy modes available:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1475
#, no-c-format
msgid ""
"<literal>interleave</literal>: This is a memory placement policy which is "
"also known as round-robin. This policy can provide substantial improvements "
"for jobs that need to place thread local data on the corresponding node. "
"When the interleave destination is not available, it will be moved to "
"another node."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1484
#, no-c-format
msgid ""
"<literal>bind</literal>: This will place memory only on one node, which "
"means in case of insufficient memory, the allocation will fail."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1490
#, no-c-format
msgid ""
"<literal>preferred</literal>: This policy will apply a preference to "
"allocate memory to a node, but if there is not enough space for memory on "
"this node, it will fall back to another node."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1497
#, no-c-format
msgid ""
"You can change the memory policy mode with the <command>cgset</command> tool "
"from the <package>libcgroup-tools</package> package:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1501
#, no-c-format
msgid ""
"# cgset -r cpuset.mems=<replaceable>NODE</replaceable> sysdefault/libvirt/"
"qemu/<replaceable>KVM_NAME</replaceable>/emulator"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1502
#, no-c-format
msgid ""
"To migrate pages to a node, use the <command>migratepages</command> tool:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1506
#, no-c-format
msgid ""
"# migratepages <replaceable>PID</replaceable> <replaceable>FROM-NODE</"
"replaceable> <replaceable>TO-NODE</replaceable>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1507
#, no-c-format
msgid ""
"To check everything is fine. use: <command>cat /proc/<replaceable>PID</"
"replaceable>/status | grep Cpus</command>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1512
#, no-c-format
msgid "Kernel NUMA/cpuset memory policy"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1513
#, no-c-format
msgid ""
"For more information see <link xlink:href=\"https://www.kernel.org/doc/"
"Documentation/vm/numa_memory_policy.txt\">Kernel NUMA memory policy</link> "
"and <link xlink:href=\"https://www.kernel.org/doc/Documentation/cgroups/"
"cpusets.txt\">cpusets memory policy</link>. Check also the <link xlink:href="
"\"https://libvirt.org/formatdomain.html#elementsNUMATuning\">Libvirt NUMA "
"Tuning documentation</link>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1525
#, no-c-format
msgid "&vmguest;: NUMA Related Configuration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1526
#, no-c-format
msgid ""
"&libvirt; allows to set up virtual NUMA and memory access policies. "
"Configuring theses settings is not supported by <command>virt-install</"
"command> or <command>virt-manager</command> and needs to be done manually by "
"editing the &vmguest; configuration file with <command>virsh edit</command>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1534
#, no-c-format
msgid "&vmguest; Virtual NUMA Topology"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1535
#, no-c-format
msgid ""
"Creating a &vmguest; virtual NUMA (vNUMA) policy that resembles the host "
"NUMA topology can often increase performace of traditional large, scale-up "
"workloads. &vmguest; vNUMA topology can be specified using the "
"<emphasis>numa</emphasis> element in the XML configuration:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1541
#, no-c-format
msgid ""
"&lt;cpu&gt;\n"
"...\n"
"  &lt;numa&gt;\n"
"    &lt;cell<co xml:id=\"co.numa.cell\"/> id='0'<co xml:id=\"co.numa.id\"/> "
"cpus='0-1'<co xml:id=\"co.numa.cpus\"/> memory='512000' unit='KiB'/&gt;\n"
"    &lt;cell id='1' cpus='2-3' memory='256000'<co xml:id=\"co.numa.mem\"/>\n"
"    unit='KiB'<co xml:id=\"co.numa.unit\"/> memAccess='shared'<co\n"
"    xml:id=\"co.numa.memaccess\"/>/&gt;\n"
"  &lt;/numa&gt;\n"
"  ...\n"
"&lt;/cpu&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1544
#, no-c-format
msgid "Each <emphasis>cell</emphasis> element specifies a vNUMA cell or node"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1550
#, no-c-format
msgid ""
"All cells should have an <emphasis>id</emphasis> attribute, allowing to "
"reference the cell in other configuration blocks. Otherwise cells are "
"assigned ids in ascending order starting from 0."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1557
#, no-c-format
msgid "cpus specifies the CPU or range of CPUs that are part of the node"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1562
#, no-c-format
msgid "The node memory"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1567
#, no-c-format
msgid "Units in which node memory is specified"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1572
#, no-c-format
msgid ""
"Optional attribute which can control whether the memory is to be mapped as "
"<option>shared</option> or <option>private</option>. This is valid only for "
"hugepages-backed memory."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1579
#, no-c-format
msgid ""
"To find where the &vmguest; has allocated its pages. use: <command>cat /proc/"
"<replaceable>PID</replaceable>/numa_maps</command> and <command>cat /sys/fs/"
"cgroup/memory/sysdefault/libvirt/qemu/<replaceable>KVM_NAME</replaceable>/"
"memory.numa_stat</command>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1586
#, no-c-format
msgid "NUMA specification"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1587
#, no-c-format
msgid ""
"The &libvirt; &vmguest; NUMA specification is currently only available for "
"QEMU/KVM."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1594
#, no-c-format
msgid "Memory Allocation Control with &libvirt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1595
#, no-c-format
msgid ""
"If the &vmguest; has a vNUMA topology (see <xref linkend=\"vt.best.perf.numa."
"vmguest.topo\"/>), memory can be pinned to host NUMA nodes using the "
"<emphasis>numatune</emphasis> element. This method is currently only "
"available for &qemu;/&kvm; guests. See <xref linkend=\"vt.best.perf.numa."
"alloc_libvirt.non-vnuma\"/> for how to configure non-vNUMA &vmguest;s."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1603
#, no-c-format
msgid ""
"&lt;numatune&gt;\n"
"    &lt;memory mode=\"strict\"<co xml:id=\"co.numat.mode\"/> nodeset=\"1-4,"
"^3\"<co xml:id=\"co.numat.nodeset\"/>/&gt;\n"
"    &lt;memnode<co xml:id=\"co.numat.memnode\"/> cellid=\"0\"<co xml:id=\"co."
"numat.cellid\"/> mode=\"strict\" nodeset=\"1\"/&gt;\n"
"    &lt;memnode cellid=\"2\" placement=\"strict\"<co xml:id=\"co.numat."
"placement\"/> mode=\"preferred\" nodeset=\"2\"/&gt;\n"
"&lt;/numatune&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1606
#, no-c-format
msgid ""
"Policies available are: <emphasis>interleave</emphasis> (round-robin like), "
"<emphasis>strict</emphasis> (default) or <emphasis>preferred</emphasis>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1613
#, no-c-format
msgid "Specify the NUMA nodes."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1618
#, no-c-format
msgid ""
"Specify memory allocation policies for each guest NUMA node (if this element "
"is not defined then this will fall back and use the <emphasis>memory</"
"emphasis> element)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1625
#, no-c-format
msgid "Addresses the guest NUMA node for which the settings are applied."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1630
#, no-c-format
msgid ""
"The placement attribute can be used to indicate the memory placement mode "
"for a domain process, the value can be <emphasis>auto</emphasis> or "
"<emphasis>strict</emphasis>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1638
#, no-c-format
msgid "Non-vNUMA &vmguest;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1639
#, no-c-format
msgid ""
"On a non-vNUMA &vmguest;, pinning memory to host NUMA nodes is done like in "
"the following example:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1643
#, no-c-format
msgid ""
"&lt;numatune&gt;\n"
"   &lt;memory mode=\"strict\" nodeset=\"0-1\"/&gt;\n"
"&lt;/numatune&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1644
#, no-c-format
msgid ""
"In this example memory is allocated from the host nodes <literal>0</literal> "
"and <literal>1</literal>. In case these memory requirements cannot be "
"fullfilled, staring the &vmguest; will fail. <command>virt-install</command> "
"also supports this configuration with the <option>--numatune</option> option."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1654
#, no-c-format
msgid "Memory and CPU across NUMA nodes"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1655
#, no-c-format
msgid ""
"You should avoid allocating &vmguest; memory across NUMA nodes, and prevent "
"virtual CPUs from floating across NUMA nodes."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1666
#, no-c-format
msgid "&vmguest; Images"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1667
#, no-c-format
msgid ""
"Images are virtual disks used to store the opreating system and data of "
"&vmguest;s. They can be created, maintained and queried with the "
"<command>qemu-img</command> command. Refer to <link xlink:href=\"https://www."
"suse.com/documentation/sles-12/singlehtml/book_virt/book_virt.html#cha.qemu."
"guest_inst.qemu-img.create\">SLE12 qemu-img documentation</link> for more "
"information on the <command>qemu-img</command> tool and examples."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1676
#, no-c-format
msgid "&vmguest; Image Formats"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1677
#, no-c-format
msgid ""
"Certain storage formats which &qemu; recognizes have their origins in other "
"virtualization technologies. By recognizing these formats, &qemu; can "
"leverage either data stores or entire guests that were originally targeted "
"to run under these other virtualization technologies. Some formats are "
"supported only in read-only mode, enabling either direct use of that read-"
"only data store in a &qemu; guest or conversion to a fully supported &qemu; "
"storage format (using <command>qemu-img</command>) which could then be used "
"in read/write mode. See &sle; <link xlink:href=\"https://www.suse.com/"
"releasenotes/x86_64/SUSE-SLES/12/#fate-317891\">Release Notes</link> to get "
"the list of supported formats."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1689
#, no-c-format
msgid ""
"Use <command>qemu-img info <replaceable>vmguest.img</replaceable></command> "
"to get information about an existing image, such as: the format, the virtual "
"size, the physical size, snapshots if available."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1695
#, no-c-format
msgid ""
"It is recommended to convert the disk images to either raw or qcow2 to "
"achieve good performance."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1701
#, no-c-format
msgid "Encrypted Images Cannot be Compressed"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1702
#, no-c-format
msgid ""
"When you create an image, you cannot use compression (<option>-c</option>) "
"in the output file together with the encryption option (<option>-e</option>)."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1709
#, no-c-format
msgid "Raw Format"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1713
#, no-c-format
msgid ""
"This format is simple and easily exportable to all other emulators/"
"hypervisors."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1719
#, no-c-format
msgid "It provides best performance (least I/O overhead)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1724
#, no-c-format
msgid ""
"If your file system supports holes (for example in ext2 or ext3 on Linux or "
"NTFS on Windows*), then only the written sectors will reserve space."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1731
#, no-c-format
msgid ""
"The raw format allows to copy a &vmguest; image to a physical device "
"(<command>dd if=<replaceable>vmguest.raw</replaceable> of=<replaceable>/dev/"
"sda</replaceable></command>)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1738
#, no-c-format
msgid ""
"It is byte-for-byte the same as what the &vmguest; sees, so this wastes a "
"lot of space."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1746
#, no-c-format
msgid "qcow2 Format"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1750
#, no-c-format
msgid ""
"Use this to have smaller images (useful if your file system does not "
"supports holes, for example on Windows*)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1756
#, no-c-format
msgid "It has optional AES encryption."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1761
#, no-c-format
msgid "Zlib-based compression option."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1766
#, no-c-format
msgid "Support of multiple VM snapshots (internal, external)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1771
#, no-c-format
msgid "Improved performance and stability."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1776 vt_best_practices.xml:1859
#, no-c-format
msgid "Supports changing the backing file."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1781 vt_best_practices.xml:1864
#, no-c-format
msgid "Supports consistency checks."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1786
#, no-c-format
msgid "Less performance than raw format."
msgstr ""

#. Tag: term
#: vt_best_practices.xml:1793
#, no-c-format
msgid "12-cache-size"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1795
#, no-c-format
msgid ""
"qcow2 can provide the same performance for random read/write access as raw "
"format, but it needs a well-sized cache size. By default cache size is set "
"to 1 MB. This will give good performance up to a disk size of 8 GB. If you "
"need a bigger disk size, you need to adjust the cache size. For a disk size "
"of 64 GB (64*1024 = 65536), you need 65536 / 8192B = 8 MB of cache (<option>-"
"drive format=qcow2,12-cache-size=8M</option>)."
msgstr ""

#. Tag: term
#: vt_best_practices.xml:1807
#, no-c-format
msgid "Cluster Size"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1809
#, no-c-format
msgid ""
"The qcow2 format offers the capability to change the cluster size. The value "
"must be between 512&nbsp;KB and 2&nbsp;MB. Smaller cluster sizes can improve "
"the image file size whereas larger cluster sizes generally provide better "
"performance."
msgstr ""

#. Tag: term
#: vt_best_practices.xml:1818
#, no-c-format
msgid "Pre-allocation"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1820
#, no-c-format
msgid ""
"An image with preallocated metadata is initially larger but can improve "
"performance when the image needs to grow."
msgstr ""

#. Tag: term
#: vt_best_practices.xml:1827
#, no-c-format
msgid "Lazy Refcounts"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1829
#, no-c-format
msgid ""
"Reference count updates are postponed with the goal of avoiding metadata I/O "
"and improving performance. This is particularly beneficial with "
"<option>cache=writethrough</option>, which does not batch metadata updates, "
"but in case of host crash, the reference count tables must be rebuilt, this "
"is done automatically at the next open with <command>qemu-img check -r all</"
"command>, but this takes some time."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1842
#, no-c-format
msgid "qed format"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1843
#, no-c-format
msgid ""
"qed is the next-generation qcow (Qemu Copy On Write). Its characteristics "
"include:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1849
#, no-c-format
msgid "Strong data integrity because of simple design."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1854
#, no-c-format
msgid "Retains sparseness over non-sparse channels (for example HTTP)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1869
#, no-c-format
msgid "Fully asynchronous I/O path."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1874
#, no-c-format
msgid "Does not support internal snapshots."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1879
#, no-c-format
msgid ""
"Relies on the host file system and cannot be stored on a logical volume "
"directly."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1887
#, no-c-format
msgid "VMDK format"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1888
#, no-c-format
msgid ""
"VMware 3, 4, or 6 image format, for exchanging images with that product."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1895
#, no-c-format
msgid "Overlay Disk Images"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1896
#, no-c-format
msgid ""
"The qcow2 and qed formats provide a way to create a base image (also called "
"backing file) and overlay images on top of the base image. A backing file is "
"useful to be able to revert to a known state and discard the overlay. If you "
"write to the image, the backing image will be untouched and all changes will "
"be recorded in the overlay image file. The backing file will never be "
"modified unless you use the <option>commit</option> monitor command (or "
"<command>qemu-img commit</command>)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1906
#, no-c-format
msgid "To create an overlay image:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1909
#, no-c-format
msgid ""
"# qemu-img create -o<co xml:id=\"co.1.minoro\"/>backing_file=vmguest.raw<co "
"xml:id=\"co.1.backingfile\"/>,backing_fmt=raw<co xml:id=\"co.1.backingfmt\"/>"
"\\\n"
"     -f<co xml:id=\"co.1.minorf\"/> qcow2 vmguest.cow<co xml:id=\"co.1."
"imagename\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1912
#, no-c-format
msgid "Use <option>-o ?</option> for an overview of available options."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1917
#, no-c-format
msgid "The backing file name."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1922
#, no-c-format
msgid "Specify the file format for the backing file."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1927
#, no-c-format
msgid "Specify the image format for the &vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1932
#, no-c-format
msgid ""
"Image name of the &vmguest;, it will only record the differences from the "
"backing file."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:1939
#, no-c-format
msgid "Backing Image Path"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1940
#, no-c-format
msgid ""
"You should not change the path to the backing image, otherwise you will need "
"to adjust it. The path is stored in the overlay image file. If you want to "
"update the path, you should make a symbolic link from the original path to "
"the new path and then use the <command>qemu-img</command> <option>rebase</"
"option> option."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1947
#, no-c-format
msgid ""
"ln -sf /var/lib/images/vmguest.raw  /var/lib/images/SLE12/vmguest.raw\n"
"     qemu-img rebase<co xml:id=\"co.2.rebase\"/>-u<co xml:id=\"co.2.unsafe\"/"
"> -b<co xml:id=\"co.2.minorb\"/> /var/lib/images/vmguest.raw /var/lib/images/"
"SLE12/vmguest.cow<co xml:id=\"co.2.image\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1948
#, no-c-format
msgid ""
"The <command>rebase</command> subcommand tells <command>qemu-img</command> "
"to change the backing file image. The <option>-u</option> option activates "
"the unsafe mode (see note below). The backing image to be used is specified "
"with <option>-b</option> and the image path is the last argument of the "
"command."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1955
#, no-c-format
msgid ""
"There are two different modes in which <option>rebase</option> can operate:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1961
#, no-c-format
msgid ""
"<emphasis>Safe</emphasis>: This is the default mode and performs a real "
"rebase operation. The safe mode is a time-consuming operation."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1967
#, no-c-format
msgid ""
"<emphasis>Unsafe</emphasis>: The unsafe mode (<option>-u</option>) only "
"changes the backing files name and the format of the file name without "
"making any checks on the files contents. You should use this mode to rename "
"or moving a backing file."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1976
#, no-c-format
msgid ""
"A common use is to initiate a new guest with the backing file. Let's assume "
"we have a <filename>sle12_base.img</filename> &vmguest; ready to be used "
"(fresh installation without any modification). This will be our backing "
"file. Now you need to test a new package, on an updated system and on a "
"system with a different kernel. We can use <filename>sle12_base.img</"
"filename> to instantiate the new &sle; &vmguest; by creating a qcow2 overlay "
"file pointing to this backing file (<filename>sle12_base.img</filename>)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1986
#, no-c-format
msgid ""
"In our example we will use <filename>sle12_updated.qcow2</filename> for the "
"updated system, and <filename>sle12_kernel.qcow2</filename> for the system "
"with a different kernel."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1991
#, no-c-format
msgid ""
"To create the two thin provisioned systems use the <command>qemu-img</"
"command> command line with the <option>-b</option> option:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:1996
#, no-c-format
msgid ""
"&prompt.root;qemu-img create -b /var/lib/libvirt/sle12_base.img -f qcow2 \\\n"
"/var/lib/libvirt/sle12_updated.qcow2\n"
"Formatting 'sle12_updated.qcow2', fmt=qcow2 size=17179869184\n"
"backing_file='sle12_base.img' encryption=off cluster_size=65536\n"
"lazy_refcounts=off nocow=off\n"
"&prompt.root;qemu-img create -b /var/lib/libvirt/sle12_base.img -f qcow2 \\\n"
"/var/lib/libvirt/sle12_kernel.qcow2\n"
"Formatting 'sle12_kernel.qcow2', fmt=qcow2 size=17179869184\n"
"backing_file='vmguest-sle12_base.img' encryption=off cluster_size=65536\n"
"lazy_refcounts=off nocow=off"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:1997
#, no-c-format
msgid ""
"The images are now usable, and you can do your test without touching the "
"initial <filename>sle12_base.img</filename> backing file, all changes will "
"be stored in the new overlay images. Whatsmore, you can also use these new "
"images as a backing file, and create a new overlay."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2003
#, no-c-format
msgid "qemu-img create -b sle12_kernel.qcow2 -f qcow2 sle12_kernel_TEST.qcow2"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2004
#, no-c-format
msgid ""
"When using <command>qemu-img info</command> with the option <option>--"
"backing-chain</option>, it will return all information about the entire "
"backing chain recursively:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2009
#, no-c-format
msgid ""
"&prompt.root;qemu-img info --backing-chain\n"
"/var/lib/libvirt/images/sle12_kernel_TEST.qcow2\n"
"image: sle12_kernel_TEST.qcow2\n"
"file format: qcow2\n"
"virtual size: 16G (17179869184 bytes)\n"
"disk size: 196K\n"
"cluster_size: 65536\n"
"backing file: sle12_kernel.qcow2\n"
"Format specific information:\n"
"compat: 1.1\n"
"lazy refcounts: false\n"
"\n"
"image: sle12_kernel.qcow2\n"
"file format: qcow2\n"
"virtual size: 16G (17179869184 bytes)\n"
"disk size: 196K\n"
"cluster_size: 65536\n"
"backing file: SLE12.qcow2\n"
"Format specific information:\n"
"compat: 1.1\n"
"lazy refcounts: false\n"
"\n"
"image: sle12_base.img\n"
"file format: qcow2\n"
"virtual size: 16G (17179869184 bytes)\n"
"disk size: 16G\n"
"cluster_size: 65536\n"
"Format specific information:\n"
"compat: 1.1\n"
"lazy refcounts: true"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2011
#, no-c-format
msgid "Understanding Image Overlay"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2074
#, no-c-format
msgid "Opening a &vmguest; Image"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2075
#, no-c-format
msgid ""
"To access the file system of an image, use the <package>guestfs-tools</"
"package>. If you do not have this tool installed on your system you can "
"mount an image with other Linux tools, but you should avoid accessing an "
"untrusted or unknown &vmguest;'s image system because this can lead to "
"security issues (read <link xlink:href=\"https://www.berrange.com/"
"posts/2013/02/20/a-reminder-why-you-should-never-mount-guest-disk-images-on-"
"the-host-os/\">D. Berrang's post</link> for more information)."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2085
#, no-c-format
msgid "Opening a Raw Image"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2087
#, no-c-format
msgid "Mounting a Raw Image"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2089
#, no-c-format
msgid ""
"To be able to mount the image, find a free loop device. The following "
"command display the first unused loop device, <filename>/dev/loop1</"
"filename> in this example."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2094
#, no-c-format
msgid ""
"&prompt.root;losetup -f\n"
"/dev/loop1"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2097
#, no-c-format
msgid ""
"Associate an image (<filename>SLE12.raw</filename> in this example) with the "
"loop device:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2101
#, no-c-format
msgid "losetup /dev/loop1 SLE12.raw"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2104
#, no-c-format
msgid ""
"Check whether the images has successfully been associated with the loop "
"device by getting detailed information about the loop device:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2108
#, no-c-format
msgid ""
"# losetup -l\n"
"NAME       SIZELIMIT OFFSET AUTOCLEAR RO BACK-FILE\n"
"/dev/loop1         0      0         0  0    /var/lib/libvirt/images/SLE12.raw"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2111
#, no-c-format
msgid "Check the image's partitions with <command>kpartx</command>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2114
#, no-c-format
msgid ""
"&prompt.root;kpartx -a<co xml:id=\"co.kpartx.a\"/> -v<co xml:id=\"co.kpartx.v"
"\"/> /dev/loop1\n"
"add map loop1p1 (254:1): 0 29358080 linear /dev/loop1 2048"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2117
#, no-c-format
msgid "Add partition device mappings."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2122
#, no-c-format
msgid "Verbose mode."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2129
#, no-c-format
msgid ""
"Now mount the image partition(s) (to <filename>/mnt/sle12mount</filename> in "
"the following example):"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2133
#, no-c-format
msgid ""
"mkdir /mnt/sle12mount\n"
"mount /dev/mapper/loop1p1 /mnt/sle12mount"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2137
#, no-c-format
msgid "Raw image with LVM"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2138
#, no-c-format
msgid ""
"If your raw image contains an LVM volume group you should use LVM tools to "
"mount the partition. Refer to <xref linkend=\"sect4.lvm.found\"/>"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2146
#, no-c-format
msgid "Unmounting a Raw Image"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2148 vt_best_practices.xml:2252
#, no-c-format
msgid "Unmount all mounted partitions of the image, for example:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2151
#, no-c-format
msgid "umount /mnt/sle12mount"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2154
#, no-c-format
msgid "Delete partition device mappings with <command>kpartx</command>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2157
#, no-c-format
msgid "# kpartx -d /dev/loop1"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2160
#, no-c-format
msgid "Detach the devices with <command>losetup</command>"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2163
#, no-c-format
msgid "# losetup -d /dev/loop1"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2169
#, no-c-format
msgid "Opening a qcow2 Image"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2171
#, no-c-format
msgid "Mounting a qcow2 Image"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2173
#, no-c-format
msgid ""
"First you need to load the <emphasis>nbd</emphasis> (network block devices) "
"module. The following example loads it with support for 16 block devices "
"(<option>max_part=16</option>). Check with <command>dmesg</command> whether "
"the opreation was successful:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2179
#, no-c-format
msgid ""
"&prompt.root;modprobe nbd max_part=16\n"
"&prompt.root;dmesg | grep nbd\n"
"[89155.142425] nbd: registered device at major 43"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2182
#, no-c-format
msgid ""
"Connect the &vmguest; image (for example <filename>SLE12.qcow2</filename>) "
"to an NBD device (<filename>/debv/nbd0</filename> in the following example) "
"with the <command>qemu-nbd</command> command. Make sure to use a free NBD "
"device:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2188
#, no-c-format
msgid ""
"# qemu-nbd -c<co xml:id=\"co.qemunbd.minusc\"/> /dev/nbd0<co xml:id=\"co."
"qemunbd.device\"/> SLE12.qcow2<co xml:id=\"co.qemunbd.image\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2191
#, no-c-format
msgid ""
"Connect <filename>SLE12.qcow2</filename> to the local NBD device <filename>/"
"dev/nbd0</filename>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2197
#, no-c-format
msgid "NBD device to use"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2202
#, no-c-format
msgid "&vmguest; image to use"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2208
#, no-c-format
msgid "Checking for a free NBD devices"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2209
#, no-c-format
msgid "To check whether an NBD device is free run the following command:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2212
#, no-c-format
msgid ""
"&prompt.root;lsof /dev/nbd0\n"
"COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF  NODE NAME\n"
"qemu-nbd 15149 root   10u   BLK   43,0      0t0 47347 /dev/nbd0"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2213
#, no-c-format
msgid ""
"If the command produces an output like in the example above, the device is "
"busy (not free). This can also be confirmed by the presence of the "
"<filename>/sys/devices/virtual/block/nbd0/pid</filename> file."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2221
#, no-c-format
msgid ""
"Inform the operating system about partition table changes with "
"<command>partprobe</command>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2225
#, no-c-format
msgid ""
"&prompt.root;partprobe /dev/nbd0 -s\n"
"/dev/nbd0: msdos partitions 1 2\n"
"&prompt.root;dmesg | grep nbd0 | tail -1\n"
"[89699.082206]  nbd0: p1 p2"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2228
#, no-c-format
msgid ""
"In the example above, the <filename>SLE12.qcow2</filename> contains two "
"partitions: <filename>/dev/nbd0p1</filename> and <filename>/dev/nbd0p2</"
"filename>. Before mounting these partitions, use <command>vgscan</command> "
"to check whther they belong to an LVM volume:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2234
#, no-c-format
msgid ""
"# vgscan -v\n"
"    Wiping cache of LVM-capable devices\n"
"    Wiping internal VG cache\n"
"    Reading all physical volumes. This may take a while...\n"
"    Using volume group(s) on command line.\n"
"    No volume groups found."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2237
#, no-c-format
msgid ""
"If no LVM volume has been found, you can mount the partition with "
"<command>mount</command>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2241
#, no-c-format
msgid ""
"# mkdir /mnt/nbd0p2\n"
"# mount /dev/nbd0p1 /mnt/nbd0p2"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2242
#, no-c-format
msgid ""
"Refer to <xref linkend=\"sect4.lvm.found\"/> for information on how to "
"handle LVM volumes."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2250
#, no-c-format
msgid "Unmounting a qcow2 Image"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2255
#, no-c-format
msgid "umount /mnt/nbd0p2"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2258
#, no-c-format
msgid "Disconnect the image from the <filename>/dev/nbd0</filename> device"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2261
#, no-c-format
msgid "qemu-nbd -d /dev/nbd0"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2267
#, no-c-format
msgid "Opening Images Containing LVM"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2270
#, no-c-format
msgid "Mounting Images Containing LVM"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2272
#, no-c-format
msgid ""
"To check images for LVM groups use <command>vgscan -v</command>. If an image "
"contains LVM groups, the output of the command looks like the following:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2277
#, no-c-format
msgid ""
"&prompt.root;vgscan -v\n"
"Wiping cache of LVM-capable devices\n"
"Wiping internal VG cache\n"
"Reading all physical volumes.  This may take a while...\n"
"Finding all volume groups\n"
"Finding volume group \"system\"\n"
"Found volume group \"system\" using metadata type lvm2"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2280
#, no-c-format
msgid ""
"The <emphasis>system</emphasis> LVM volume group has been found on the "
"system. You can get more information about this volume with "
"<command>vgdisplay <replaceable>VOLUMEGROUPNAME</replaceable></command> (in "
"our case <replaceable>VOLUMEGROUPNAME</replaceable> is <emphasis>system</"
"emphasis>). You should activate this volume group to expose LVM partitions "
"as devices so the system can mount them. Use <command>vgchange</command>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2289
#, no-c-format
msgid ""
"# vgchange -ay -v\n"
"Finding all volume groups\n"
"Finding volume group \"system\"\n"
"Found volume group \"system\"\n"
"activation/volume_list configuration setting not defined: Checking only\n"
"host tags for system/home\n"
"Creating system-home\n"
"Loading system-home table (254:0)\n"
"Resuming system-home (254:0)\n"
"Found volume group \"system\"\n"
"activation/volume_list configuration setting not defined: Checking only\n"
"host tags for system/root\n"
"Creating system-root\n"
"Loading system-root table (254:1)\n"
"Resuming system-root (254:1)\n"
"Found volume group \"system\"\n"
"activation/volume_list configuration setting not defined: Checking only\n"
"host tags for system/swap\n"
"Creating system-swap\n"
"Loading system-swap table (254:2)\n"
"Resuming system-swap (254:2)\n"
"Activated 3 logical volumes in volume group system\n"
"    3 logical volume(s) in volume group \"system\" now active"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2292
#, no-c-format
msgid ""
"All partitions in the volume group will be listed in the <filename>/dev/"
"mapper</filename> directory. You can simply mount them now."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2297
#, no-c-format
msgid ""
"&prompt.root;ls /dev/mapper/system-*\n"
"/dev/mapper/system-home  /dev/mapper/system-root /dev/mapper/system-swap\n"
"\n"
"&prompt.root;mkdir /mnt/system-root\n"
"&prompt.root;mount  /dev/mapper/system-root /mnt/system-root\n"
"\n"
"&prompt.root;ls /mnt/system-root/\n"
"bin   dev  home  lib64       mnt  proc        root  sbin     srv  tmp  var\n"
"boot  etc  lib   lost+found  opt  read-write  run   selinux  sys  usr"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2301
#, no-c-format
msgid "Unmounting Images Containing LVM"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2303
#, no-c-format
msgid "Unmount all partitions (with <command>umount</command>)"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2306
#, no-c-format
msgid "# umount /mnt/system-root"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2309
#, no-c-format
msgid ""
"Deactivate the LVM volume group (with <command>vgchange -an "
"<replaceable>VOLUMEGROUPNAME</replaceable></command>)"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2313
#, no-c-format
msgid ""
"# vgchange -an -v system\n"
"Using volume group(s) on command line\n"
"Finding volume group \"system\"\n"
"Found volume group \"system\"\n"
"Removing system-home (254:0)\n"
"Found volume group \"system\"\n"
"Removing system-root (254:1)\n"
"Found volume group \"system\"\n"
"Removing system-swap (254:2)\n"
"Deactivated 3 logical volumes in volume group system\n"
"0 logical volume(s) in volume group \"system\" now active"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2316
#, no-c-format
msgid "Now you you have two choices:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2321
#, no-c-format
msgid ""
"If case of a qcow2 image, proceed as described in <xref linkend=\"step."
"umount.qcow2\"/> (<command>qemu-nbd -d /dev/nbd0</command>)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2328
#, no-c-format
msgid ""
"In case of a raw image, proceeds as described in <xref linkend=\"step.umount."
"raw\"/> (<command>kpartx -d /dev/loop1</command>; <command>losetup -d /dev/"
"loop1</command>)."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2336
#, no-c-format
msgid "Check for a Successful Unmount"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2337
#, no-c-format
msgid ""
"You should double-check that umounting succeeded by using a system command "
"like <command>losetup</command>, <command>qemu-nbd</command>, "
"<command>mount</command> or <command>vgscan</command>. If this is not the "
"case you may have trouble using the &vmguest; because its system image is "
"used in different places."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2351
#, no-c-format
msgid "File System Sharing"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2352
#, no-c-format
msgid ""
"You can access a host directory in the &vmguest; using the <tag class="
"\"element\">filesystem</tag> element. In the following example we will share "
"the <filename>/data/shared</filename> directory and mount it in the "
"&vmguest;. Note that the <tag class=\"attribute\">accessmode</tag> parameter "
"only works with <tag class=\"attribute\">type='mount'</tag> for the QEMU/KVM "
"drive (most other values for <tag class=\"attribute\">type</tag> are "
"exclusively used for the LXC driver)."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2361
#, no-c-format
msgid ""
"&lt;filesystem type='mount'<co xml:id=\"co.fs.mount\"/> "
"accessmode='mapped'<co xml:id=\"co.fs.mode\"/>&gt;\n"
"   &lt;source dir='/data/shared'<co xml:id=\"co.fs.sourcedir\"/>&gt;\n"
"   &lt;target dir='shared'<co xml:id=\"co.fs.targetdir\"/>/&gt;\n"
"&lt;/filesystem&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2364
#, no-c-format
msgid "A host directory to mount &vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2369
#, no-c-format
msgid ""
"Access mode (the security mode) set to <emphasis>mapped</emphasis> will give "
"access with the permissions of the hypervisor. Use <emphasis>passthrough</"
"emphasis> to access this share with the permissions of the user inside the "
"&vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2377
#, no-c-format
msgid "Path to share with the &vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2382
#, no-c-format
msgid "Name or label of the path for the mount command."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2387
#, no-c-format
msgid ""
"To mount the <literal>shared</literal> directory on the &vmguest;, use the "
"following commands: Under the &vmguest; now you need to mount the "
"<emphasis>target dir='shared'</emphasis>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2393
#, no-c-format
msgid ""
"mkdir /opt/mnt_shared\n"
"mount shared -t 9p /opt/mnt_shared -o trans=virtio"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2394
#, no-c-format
msgid ""
"See <link xlink:href=\"https://libvirt.org/formatdomain."
"html#elementsFilesystems\">&libvirt; File System </link> and <link xlink:"
"href=\"http://wiki.qemu.org/Documentation/9psetup\">&qemu; 9psetup</link> "
"for more information."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2405
#, no-c-format
msgid "&vmguest; Configuration"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2410
#, no-c-format
msgid "Virtio Driver"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2411
#, no-c-format
msgid ""
"To increase &vmguest; performance it is recommended to use para-virtualized "
"drivers within the &vmguest;s. The virtualization standard for such drivers "
"for &kvm; are the <literal>virtio</literal> drivers, that are aware that "
"they are running in a virtual environment. &xen; is using similar "
"paravirtualized device drivers (like <link xlink:href=\"https://www.suse.com/"
"products/vmdriverpack/\">VMDP</link> in a Windows* guest). To have a better "
"understanding of this topic refer to the <link xlink:href=\"https://www.suse."
"com/documentation/sles-12/book_virt/data/sec_vt_io.html\">I/O "
"Virtualization</link> section in the official Virtualization guide."
msgstr ""

#. Tag: literal
#: vt_best_practices.xml:2425
#, no-c-format
msgid "virtio blk"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2426
#, no-c-format
msgid ""
"<literal>virtio_blk</literal> is the virtio block device for disk. To use "
"the <literal>virtio blk</literal> driver for a block device, specify the "
"<tag class=\"attribute\">bus='virtio'</tag> attribute in the <tag class="
"\"element\">disk</tag> definition:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2432
#, no-c-format
msgid ""
"&lt;disk type='....' device='disk'&gt;\n"
"    ....\n"
"    &lt;target dev='vda' bus='virtio'/&gt;\n"
"&lt;/disk&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2435
#, no-c-format
msgid "Disk Device Names"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2436
#, no-c-format
msgid ""
"<literal>virtio</literal> disk devices are named <literal>/dev/vd[a-z][1-9]</"
"literal>. If you migrate a Linux guest from a non-virtio disk you need to "
"adjust the <literal>root=</literal> parameter in the GRUB configuration, and "
"regenerate the <filename>initrd</filename> file, otherwise the system will "
"not be able to boot. On &vmguest;s with other operating systems, the boot "
"loader needs to be adjusted or reinstalled, too."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2448
#, no-c-format
msgid ""
"Using <literal>virtio</literal> disks with <command>qemu-system-ARCH</"
"command>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2452
#, no-c-format
msgid ""
"When running <command>qemu-system-ARCH</command>, use the <option>-drive</"
"option> option to add a disk to the &vmguest;. See the <link xlink:href="
"\"https://www.suse.com/documentation/sles-12/book_virt/data/"
"cha_qemu_guest_inst_qemu-kvm.html\">Basic Installation with qemu-system-"
"ARCH</link> section in the official Virtualization guide for an example. The "
"<option>-hd[abcd]</option> option will not work for virtio disks."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2468
#, no-c-format
msgid "virtio net"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2469
#, no-c-format
msgid ""
"<emphasis>virtio_net</emphasis> is the virtio network device. The kernel "
"modules should be insmoded automatically in the guest at boot time. You need "
"to start the service to make the network available."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2474
#, no-c-format
msgid ""
"&lt;interface type='network'&gt;\n"
"    ...\n"
"    &lt;model type='virtio' /&gt;\n"
"&lt;/interface&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2477
#, no-c-format
msgid "virtio balloon"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2478
#, no-c-format
msgid ""
"The virtio balloon is used for host memory over-commits for guests. For "
"Linux guests, the balloon driver runs in the guest kernel, whereas for "
"Windows guests, the balloon driver is in the VMDP package. "
"<emphasis>virtio_balloon</emphasis> is a PV driver to give or take memory "
"from a &vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2487
#, no-c-format
msgid ""
"<emphasis>Inflate balloon</emphasis>: Return memory from guest to host "
"kernel (for kvm) or to hypervisor (for xen)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2493
#, no-c-format
msgid ""
"<emphasis>Deflate balloon</emphasis>: Guest will have more available memory"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2499
#, no-c-format
msgid ""
"It is controlled by the <emphasis>currentMemory</emphasis> and "
"<emphasis>memory</emphasis> options."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2503
#, no-c-format
msgid ""
"&lt;memory unit='KiB'&gt;16777216&lt;/memory&gt;\n"
"    &lt;currentMemory unit='KiB'&gt;1048576&lt;/currentMemory&gt;\n"
"    [...]\n"
"    &lt;devices&gt;\n"
"    &lt;memballoon model='virtio'/&gt;\n"
"    &lt;/devices&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2504
#, no-c-format
msgid "You can also use <command>virsh</command> to change it:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2507
#, no-c-format
msgid ""
"# virsh setmem <replaceable>DOMAIN_ID</replaceable> <replaceable>MEMORY in "
"KB</replaceable>"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2510
#, no-c-format
msgid "Checking virtio Presence"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2511
#, no-c-format
msgid "You can check the virtio block pci with:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2514
#, no-c-format
msgid ""
"# find /sys/devices/ -name virtio*\n"
"/sys/devices/pci0000:00/0000:00:06.0/virtio0\n"
"/sys/devices/pci0000:00/0000:00:07.0/virtio1\n"
"/sys/devices/pci0000:00/0000:00:08.0/virtio2"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2515
#, no-c-format
msgid "To find the block device associated with <filename>vdX</filename>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2518
#, no-c-format
msgid ""
"# find /sys/devices/ -name virtio* -print  -exec ls {}/block 2&gt;/dev/null "
"\\;\n"
"/sys/devices/pci0000:00/0000:00:06.0/virtio0\n"
"/sys/devices/pci0000:00/0000:00:07.0/virtio1\n"
"/sys/devices/pci0000:00/0000:00:08.0/virtio2\n"
"vda"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2519
#, no-c-format
msgid "To get more information on the virtio block:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2522
#, no-c-format
msgid ""
"# udevadm info -p /sys/devices/pci0000:00/0000:00:08.0/virtio2\n"
"P: /devices/pci0000:00/0000:00:08.0/virtio2\n"
"E: DEVPATH=/devices/pci0000:00/0000:00:08.0/virtio2\n"
"E: DRIVER=virtio_blk\n"
"E: MODALIAS=virtio:d00000002v00001AF4\n"
"E: SUBSYSTEM=virtio"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2523
#, no-c-format
msgid "To check all virtio drivers being used:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2526
#, no-c-format
msgid ""
"# find /sys/devices/ -name virtio* -print  -exec ls -l {}/driver 2&gt;/dev/"
"null \\;\n"
"/sys/devices/pci0000:00/0000:00:06.0/virtio0\n"
"lrwxrwxrwx 1 root root 0 Jun 17 15:48 /sys/devices/pci0000:00/0000:00:06.0/"
"virtio0/driver -&gt; ../../../../bus/virtio/drivers/virtio_console\n"
"/sys/devices/pci0000:00/0000:00:07.0/virtio1\n"
"lrwxrwxrwx 1 root root 0 Jun 17 15:47 /sys/devices/pci0000:00/0000:00:07.0/"
"virtio1/driver -&gt; ../../../../bus/virtio/drivers/virtio_balloon\n"
"/sys/devices/pci0000:00/0000:00:08.0/virtio2\n"
"lrwxrwxrwx 1 root root 0 Jun 17 14:35 /sys/devices/pci0000:00/0000:00:08.0/"
"virtio2/driver -&gt; ../../../../bus/virtio/drivers/virtio_blk"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2534
#, no-c-format
msgid "Find Device Driver Options"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2535
#, no-c-format
msgid ""
"Virtio devices and other drivers have various options, to list all of them "
"use the <option>help</option> parameter of the<command>qemu-system-ARCH</"
"command> command."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2540
#, no-c-format
msgid ""
"# qemu-system-x86_64 -device virtio-net,help\n"
"virtio-net-pci.ioeventfd=on/off\n"
"virtio-net-pci.vectors=uint32\n"
"virtio-net-pci.indirect_desc=on/off\n"
"virtio-net-pci.event_idx=on/off\n"
"virtio-net-pci.any_layout=on/off\n"
"....."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2545
#, no-c-format
msgid "Cirrus Video Driver"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2546
#, no-c-format
msgid ""
"To get 16-bit color, high compatibility and better performance it is "
"recommended to use the <emphasis>cirrus</emphasis> video driver."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2551
#, no-c-format
msgid "&libvirt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2552
#, no-c-format
msgid ""
"&libvirt; ignores the vram value because video size has been hardcoded in "
"&qemu;."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2557
#, no-c-format
msgid ""
"&lt;video&gt;\n"
"   &lt;model type='cirrus' vram='9216' heads='1'/&gt;\n"
"&lt;/video&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2561
#, no-c-format
msgid "Better Entropy"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2562
#, no-c-format
msgid ""
"Virtio RNG is a paravirtualized device that is exposed as a hardware RNG "
"device to the guest. On the host side, it can be wired up to one of several "
"sources of entropy, including a real hardware RNG device as well as the "
"host's <filename>/dev/random</filename> if hardware support does not exist. "
"The Linux kernel contains the guest driver for the device from version "
"2.6.26 and higher."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2570
#, no-c-format
msgid ""
"The system entropy is collected from various non-deterministic hardware "
"events and is mainly used by cryptographic applications. The virtual random "
"number generator device (paravirtualized device) allows the host to pass "
"through entropy to &vmguest; operating systems. This results in a better "
"entropy in the &vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2577
#, no-c-format
msgid ""
"To use the <filename>hwrng</filename>, add the device in the XML "
"configuration:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2581
#, no-c-format
msgid ""
"&lt;devices&gt;\n"
"   &lt;rng model='virtio'&gt;\n"
"   &lt;backend model='random'&gt;/dev/random&lt;/backend&gt;\n"
"   &lt;/rng&gt;\n"
"&lt;/devices&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2582
#, no-c-format
msgid "The host now should used <filename>/dev/random</filename>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2585
#, no-c-format
msgid ""
"# lsof /dev/random\n"
"qemu-syst 4926 qemu    6r   CHR    1,8      0t0 8199 /dev/random"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2586
#, no-c-format
msgid ""
"On the &vmguest; the source of entropy can be checked with <command>cat /sys/"
"devices/virtual/misc/hw_random/rng_available</command> and the current "
"device used for entropy can be checked with:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2591
#, no-c-format
msgid ""
"# cat /sys/devices/virtual/misc/hw_random/rng_current\n"
"virtio_rng.0"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2592
#, no-c-format
msgid ""
"You should install the <emphasis>rn-tools</emphasis> package on the "
"&vmguest;, enable the service, and start it. Under SLE12 do the following:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2597
#, no-c-format
msgid ""
"# zypper in rng-tools\n"
"# systemctl enable rng-tools\n"
"# systemctl start rng-tools"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2601
#, no-c-format
msgid "Disable Unused Tools and Devices"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2602
#, no-c-format
msgid ""
"Per host, use one virtualization technology only. For example, do not use "
"KVM and Containers on the same computer. Otherwise, you may find yourself "
"with a reduced amount of available resources, increased security risk and a "
"longer software update queue. Even when the amount of resources allocated to "
"each of the technologies is configured carefully, the host may suffer from "
"reduced overall availability and degraded performance."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2611
#, no-c-format
msgid ""
"Minimize the amount of software and services available on hosts. Most "
"default installations of operating systems are not optimized for VM usage. "
"Install what you really need and remove all other components in the "
"&vmguest;."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2617
#, no-c-format
msgid "Windows* Guest:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2622
#, no-c-format
msgid "Disable the screen saver"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2627
#, no-c-format
msgid "Remove all graphical effects"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2632
#, no-c-format
msgid "Disable indexing of hard disks if not necessary"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2637 vt_best_practices.xml:2688
#, no-c-format
msgid "Check the list of started services and disable the ones you do not need"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2643
#, no-c-format
msgid "Check and remove all unneeded devices"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2648
#, no-c-format
msgid ""
"Disable system update if not needed, or configure it to avoid any delay "
"while rebooting or shutting down the host"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2654
#, no-c-format
msgid "Check the Firewall rules"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2659
#, no-c-format
msgid "Schedule backups and anti-virus updates appropriately"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2664
#, no-c-format
msgid ""
"Install the <link xlink:href=\"https://www.suse.com/products/vmdriverpack/"
"\">VMDP</link> para-virtualized driver for best performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2671
#, no-c-format
msgid ""
"Check the operating system recommendations, such as on the <link xlink:href="
"\"http://windows.microsoft.com/en-us/windows/optimize-windows-better-"
"performance#optimize-windows-better-performance=windows-7\">Microsoft "
"Windows* 7 better performance</link> Web page."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2678
#, no-c-format
msgid "Linux Guest:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2683
#, no-c-format
msgid "Remove Xorg start if not needed"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2694
#, no-c-format
msgid ""
"Check the OS recommendations for kernel parameters that enable better "
"performance"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2700
#, no-c-format
msgid "Only install software that you really need"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2705
#, no-c-format
msgid ""
"Optimize the scheduling of predictable tasks (system updates, hard disk "
"checks, etc.)"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2714
#, no-c-format
msgid "Updating the Guest Machine Type"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2715
#, no-c-format
msgid ""
"&qemu; machine types define some details of the architecture that are "
"particularly relevant in the context of migration and save/restore, where "
"all the details of the virtual machine ABI need to be carefully accounted "
"for. As changes or improvements to &qemu; are made or certain types of fixes "
"are done, new machine types are created which include those changes. Though "
"the older machine types used for supported versions of &qemu; are still "
"valid to use, the user would do well to try to move to the latest machine "
"type supported by the current release, so as to be able to take advantage of "
"all the changes represented in that machine type."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2727
#, no-c-format
msgid ""
"Changing the guest's machine type for a Linux guest will mostly be "
"transparent, whereas for Windows* guests, it is probably a good idea to take "
"a snapshot or backup of the guest in case Windows* has issues with the "
"changes it detects and subsequently the user decides to revert to the "
"original machine type the guest was created with."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2735
#, no-c-format
msgid "Changing the machine type"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2736
#, no-c-format
msgid ""
"Refer to the Virtualization guide section <link xlink:href=\"https://www."
"suse.com/documentation/sles-12/singlehtml/book_virt/book_virt.html#sec."
"libvirt.config.mahcinetype.virsh\">Change Machine Type</link> for "
"documentation."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2745
#, no-c-format
msgid "&vmguest;-Specific Configurations and Settings"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2748
#, no-c-format
msgid "ACPI Testing"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2749
#, no-c-format
msgid ""
"The ability to change a &vmguest;'s state heavily depends on the operating "
"system. It is very important to test this feature before any use of your "
"&vmguest; in production. For example most Linux operating system disable "
"this capability by default, so this requires you to enable this operation "
"(mostly through Policy Kit)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2756
#, no-c-format
msgid ""
"ACPI must be enabled in the guest for a graceful shutdown to work. To check "
"if ACPI is enabled, run:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2760
#, no-c-format
msgid "# virsh dumpxml <replaceable>VMNAME</replaceable> | grep acpi"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2761
#, no-c-format
msgid ""
"If nothing is printed, ACPI is not enabled for your machine. Use "
"<command>virsh edit</command> to add the following XML under &lt;domain&gt;:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2766
#, no-c-format
msgid ""
"&lt;features&gt;\n"
"   &lt;acpi/&gt;\n"
"&lt;/features&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2767
#, no-c-format
msgid ""
"If ACPI was enabled during a Windows XP/Windows Server 2003 guest "
"installation, turning it on in the &vmguest; configuration only is not "
"sufficient. For more information, see:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2784
#, no-c-format
msgid ""
"Regardless of the &vmguest;'s configuration, a graceful shutdown is always "
"possible from within the guest operating system."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2791
#, no-c-format
msgid "Keyboard Layout"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2792
#, no-c-format
msgid ""
"Though it is possible to specify the keyboard layout from a <command>qemu-"
"system-ARCH</command> command, it is recommended to do this configuration in "
"the &libvirt; XML file. To change the keyboard layout while connecting to a "
"remote &vmguest; using vnc, you should edit the &vmguest; XML configuration "
"file. The XML is located at <filename>/etc/libvirt/<replaceable>HYPERVISOR</"
"replaceable></filename>. For example, to add an \"en-us\" keymap, add in the "
"<emphasis>&lt;devices&gt;</emphasis> section:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2802
#, no-c-format
msgid "&lt;graphics type='vnc' port='-1' autoport='yes' keymap='en-us'/&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2803
#, no-c-format
msgid "Check the vncdisplay configuration and connect to your &vmguest;:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2806
#, no-c-format
msgid "# virsh vncdisplay sles12 127.0.0.1:0"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2810
#, no-c-format
msgid "Spice default listen URL"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2811
#, no-c-format
msgid ""
"If no network interface other than <emphasis>lo</emphasis> is assigned an "
"IPv4 address on the host, the default address the spice server will listen "
"on will not work. An error like the following one will occur:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2816
#, no-c-format
msgid ""
"# virsh start sles12\n"
"error: Failed to start domain sles12\n"
"error: internal error: process exited while connecting to monitor: "
"((null):26929): Spice-Warning **: reds.c:2330:reds_init_socket: "
"getaddrinfo(127.0.0.1,5900): Address family for hostname not supported\n"
"2015-08-12T11:21:14.221634Z qemu-system-x86_64: failed to initialize spice "
"server"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2817
#, no-c-format
msgid ""
"To change this you can change the default <emphasis>spice_listen</emphasis> "
"value in <filename>/etc/libvirt/qemu.conf</filename> using the local ipv6 "
"address <emphasis>::1</emphasis>. The spice server listening address can "
"also be changed on a per &vmguest; basis, use <command>virsh edit</command> "
"to add the listen XML attribute to the <emphasis>graphics type='spice'</"
"emphasis> element:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2826
#, no-c-format
msgid "&lt;graphics type='spice' listen='::1' autoport='yes'/&gt;>"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2830
#, no-c-format
msgid "XML to QEMU command line"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2831
#, no-c-format
msgid ""
"Sometimes it could be useful to get the QEMU command line to launch the "
"&vmguest; from the XML file. Use <command>virsh</command> with "
"<option>domxml</option>."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2836
#, no-c-format
msgid ""
"# virsh domxml-to-native<co xml:id=\"co.domxml.native\"/> qemu-argv<co xml:"
"id=\"co.domxml.argv\"/> SLE12.xml<co xml:id=\"co.domxml.file\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2839
#, no-c-format
msgid ""
"Convert the file xml in domain XML format to the native guest configuration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2845
#, no-c-format
msgid "For QEMU/KVM hypervisor, the format argument must be qemu-argv"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2850
#, no-c-format
msgid "Domain XML file to use"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2855
#, no-c-format
msgid ""
"# virsh domxml-to-native qemu-argv /etc/libvirt/qemu/SLE12.xml\n"
"   LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/"
"bin \\\n"
"   QEMU_AUDIO_DRV=none /usr/bin/qemu-system-x86_64 -name SLE12 -machine \\\n"
"   pc-i440fx-2.3,accel=kvm,usb=off -cpu SandyBridge -m 4048 -realtime \\\n"
"   mlock=off -smp 4,sockets=4,cores=1,threads=1 -uuid "
"8616d00f-5f05-4244-97cc-86aeaed8aea7 \\\n"
"   -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/"
"libvirt/qemu/SLE12.monitor,server,nowait \\\n"
"   -mon chardev=charmonitor,id=monitor,mode=control -rtc base=utc,"
"driftfix=slew \\\n"
"   -global kvm-pit.lost_tick_policy=discard -no-hpet \\\n"
"   -no-shutdown -global PIIX4_PM.disable_s3=1 -global PIIX4_PM.disable_s4=1 "
"\\\n"
"   -boot strict=on -device ich9-usb-ehci1,id=usb,bus=pci.0,addr=0x4.0x7 \\\n"
"   -device ich9-usb-uhci1,masterbus=usb.0,firstport=0,bus=pci.0,"
"multifunction=on,addr=0x4 \\\n"
"   -device ich9-usb-uhci2,masterbus=usb.0,firstport=2,bus=pci.0,addr=0x4.0x1 "
"\\\n"
"   -device ich9-usb-uhci3,masterbus=usb.0,firstport=4,bus=pci.0,addr=0x4.0x2 "
"\\\n"
"   -drive file=/var/lib/libvirt/images/SLE12.qcow2,if=none,id=drive-virtio-"
"disk0,format=qcow2,cache=none \\\n"
"   -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x6,drive=drive-virtio-"
"disk0,id=virtio-disk0,bootindex=2 \\\n"
"   -drive if=none,id=drive-ide0-0-1,readonly=on,format=raw  \\\n"
"   -device ide-cd,bus=ide.0,unit=1,drive=drive-ide0-0-1,id=ide0-0-1 -netdev "
"tap,id=hostnet0  \\\n"
"   -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:28:04:a9,"
"bus=pci.0,addr=0x3,bootindex=1 \\\n"
"   -chardev pty,id=charserial0 -device isa-serial,chardev=charserial0,"
"id=serial0 \\\n"
"   -vnc 127.0.0.1:0 -device cirrus-vga,id=video0,bus=pci.0,addr=0x2 \\\n"
"   -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x5 -msg "
"timestamp=on"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2859
#, no-c-format
msgid "Change Kernel Parameters at boot time"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2861
#, no-c-format
msgid "SLE11 SPX product"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2862
#, no-c-format
msgid ""
"To change the value at boot time for SLE11 SPX product, you need to modify "
"your <filename>/boot/grub/menu.lst</filename> file, adding the "
"<option>OPTION=parameter</option>, and then reboot your system."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2869
#, no-c-format
msgid "SLE12 SPX product"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2870
#, no-c-format
msgid ""
"To change the value at boot time for SLE12 SPX product, you need to modify "
"your <filename>/etc/default/grub</filename> file. Find the variable starting "
"with <option>GRUB_CMDLINE_LINUX_DEFAULT</option> and add at the end "
"<option>OPTION=parameter</option> (or change it with the correct value if it "
"is already available)."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2877
#, no-c-format
msgid "Now you need to regenerate your grub2 config with:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2880
#, no-c-format
msgid "# grub2-mkconfig -o /boot/grub2/grub.cfg"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2881
#, no-c-format
msgid "Then reboot your system"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:2888
#, no-c-format
msgid "Add Device to an XML Configuration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:2889
#, no-c-format
msgid ""
"If you want to create a new &vmguest; based on an XML file, and you are not "
"familiar with XML configuration syntax, you can specify the QEMU command "
"line using the special tag <emphasis>qemu:commandline</emphasis>. For "
"example if you want to add a virtio-balloon-pci, add this block at the end "
"of the XML configuration file (before the &lt;/domain&gt; tag)."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:2897
#, no-c-format
msgid ""
"&lt;qemu:commandline&gt;\n"
"    &lt;qemu:arg value='-device'/&gt;\n"
"    &lt;qemu:arg value='virtio-balloon-pci,id=balloon0'/&gt;\n"
"&lt;/qemu:commandline&gt;"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3203 vt_best_practices.xml:3208
#, no-c-format
msgid "Hypervisors Compared to Containers"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3216
#, no-c-format
msgid "Features"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3221
#, no-c-format
msgid "Hypervisors"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3226
#, no-c-format
msgid "Containers"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3235
#, no-c-format
msgid "Technologies"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3240
#, no-c-format
msgid "Emulation of a physical computing environment"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3245
#, no-c-format
msgid "Use kernel host"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3252
#, no-c-format
msgid "System layer level"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3257
#, no-c-format
msgid "Managed by a virtualization layer (Hypervisor)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3262
#, no-c-format
msgid "Rely on kernel namespaces and cgroups"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3269
#, no-c-format
msgid "Level (layer)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3274
#, no-c-format
msgid "Hardware level"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3279
#, no-c-format
msgid "Software level"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3286
#, no-c-format
msgid "Virtualization mode available"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3291
#, no-c-format
msgid "FV or PV"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3296
#, no-c-format
msgid "None, only user space"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3303
#, no-c-format
msgid "Security"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3308
#, no-c-format
msgid "Strong"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3314
#, no-c-format
msgid "Security is very low"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3322
#, no-c-format
msgid "Confinement"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3327
#, no-c-format
msgid "Full isolation"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3333
#, no-c-format
msgid "Host kernel (OS must be compatible with kernel version)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3341
#, no-c-format
msgid "Operating system"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3346
#, no-c-format
msgid "Any operating system"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3351
#, no-c-format
msgid "Only Linux (must be \"kernel\" compatible)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3358
#, no-c-format
msgid "Type of system"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3363
#, no-c-format
msgid "Full OS needed"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3368
#, no-c-format
msgid "Scope is an instance of Linux"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3375
#, no-c-format
msgid "Boot time"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3380
#, no-c-format
msgid "Slow to start (OS delay)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3385
#, no-c-format
msgid "Really quick start"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3392
#, no-c-format
msgid "Overhead"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3397
#, no-c-format
msgid "High"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3402
#, no-c-format
msgid "Very low"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3409
#, no-c-format
msgid "Efficiency"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3414
#, no-c-format
msgid "Depends on OS"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3419
#, no-c-format
msgid "Very efficient"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3426
#, no-c-format
msgid "Sharing with host"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3432
#, no-c-format
msgid "Complex because of isolation"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3438
#, no-c-format
msgid "Sharing is easy (host sees everything; container sees its own objects)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3446
#, no-c-format
msgid "Migration"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3451
#, no-c-format
msgid "Supports migration (live mode)"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3457
#, no-c-format
msgid "Not possible"
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3468
#, no-c-format
msgid "Getting the Best of Both Worlds"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3469
#, no-c-format
msgid ""
"Even if the above table seems to indicate that running a single application "
"in a very secure way is not possible, starting with &sls; 12 SP1 "
"<command>virt-sandbox</command> will allow running a single application in a "
"&kvm; guest. <command>virt-sandbox</command> bootstraps any command within a "
"Linux kernel with a minimal root file system."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3476
#, no-c-format
msgid ""
"The guest root file system can either be the root file system mounted read-"
"only or a disk image. The following steps will show how to set up a sandbox "
"with qcow2 disk image as root file system."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3483
#, no-c-format
msgid "Create the disk image using <command>qemu-img</command>:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3486
#, no-c-format
msgid "# qemu-img create -f qcow2 rootfs.qcow2 6G"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3489
#, no-c-format
msgid "Format the disk image:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3492
#, no-c-format
msgid ""
"# modprobe nbd<co xml:id=\"co.vsmkfs.modprobe\"/>\n"
"# /usr/bin/qemu-nbd --format qcow2 -n -c /dev/nbd0 $PWD/test-base.qcow2<co "
"xml:id=\"co.vsmkfs.qemu-nbd\"/>\n"
"# mkfs.ext3 /dev/nbd0<co xml:id=\"co.vsmkfs.do\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3495
#, no-c-format
msgid ""
"Make sure the nbd module is loaded: it is not loaded by default and will "
"only be used to format the qcow image."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3501
#, no-c-format
msgid ""
"Create an NBD device for the qcow2 image. This device will then behave like "
"any other block device. The example uses <replaceable>/dev/nbd0</"
"replaceable> but any other free NBD device will work."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3509
#, no-c-format
msgid ""
"Format the disk image directly. Note that no partition table has been "
"created: <command>virt-sandbox</command> considers the image to be a "
"partition, not a disk."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3514
#, no-c-format
msgid ""
"The partition formats that can be used are limited: the Linux kernel "
"bootstrapping the sandbox needs to have the corresponding features built in. "
"The ext4 module is also available at the sandbox start-up time."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3524
#, no-c-format
msgid "Now populate the newly formatted image:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3527
#, no-c-format
msgid ""
"# guestmount -a base.qcow2 -m /dev/sda:/ /mnt<co\n"
"     xml:id=\"co.vsfs.mount\"/>\n"
"\n"
"# zypper --root /mnt ar cd:///?devices=/dev/dvd SLES12_DVD\n"
"# zypper --root /mnt in -t pattern Minimal<co xml:id=\"co.vsfs.install\"/>\n"
"\n"
"# guestunmount /mnt<co xml:id=\"co.vsfs.unmount\"/>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3530
#, no-c-format
msgid "Mount the qcow2 image using the <command>guestfs</command> tools."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3535
#, no-c-format
msgid ""
"Use zypper with the <emphasis>--root</emphasis> parameter to add a &sls; "
"repository and install the Minimal pattern in the disk image. Any additional "
"package or configuration change should be done in this step."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3542
#, no-c-format
msgid "Using backing chains"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3543
#, no-c-format
msgid ""
"To share the root file system between several sandboxes, create qcow2 images "
"with a common disk image as backing chain as described in the <link xlink:"
"href=\"#vt.best.overlay\">Overlay Storage Image section</link>."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3552
#, no-c-format
msgid "Unmount the qcow2 image."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3559
#, no-c-format
msgid ""
"Run the sandbox, using <command>virt-sandbox</command>. This command has "
"many interesting options, read its man page to discover them all. It can "
"either be running as root or as an unprivileged user."
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3564
#, no-c-format
msgid ""
"# virt-sandbox -n <replaceable>name</replaceable> \\\n"
"     -m host-image:/=$PWD/rootfs.qcow2 \\ <co xml:id=\"co.vs.rootfs\"/>\n"
"     -m host-bind:/srv/www=/guests/www \\ <co xml:id=\"co.vs.bind\"/>\n"
"     -m ram:/tmp=100MiB \\\n"
"     -m ram:/run=100MiB \\ <co xml:id=\"co.vs.tmpfs\"/>\n"
"     -N source=default,address=192.168.122.12/24 \\ <co xml:id=\"co.vs.net\"/"
">\n"
"     -- \\\n"
"     <replaceable>/bin/sh</replaceable>"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3567
#, no-c-format
msgid ""
"Mount the created disk image as the root file system. Note that without any "
"image being mounted as <filename>/</filename>, the host root file system is "
"read-only mounted as the guest one."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3572
#, no-c-format
msgid ""
"The host-image mount is not reserved for the root file system, it can be "
"used to mount any disk image anywhere in the guest."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3578
#, no-c-format
msgid ""
"The host-bind mount is pretty convenient for sharing files and folders "
"between the host and the guest. In this example the host folder <filename>/"
"guests/www</filename> is mounted as <filename>/srv/www</filename> in the "
"sandbox."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3586
#, no-c-format
msgid ""
"The ram mounts are defining <emphasis>tmpfs</emphasis> mounts in the sandbox."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3592
#, no-c-format
msgid ""
"The network uses a network defined in libvirt. When running as an "
"unprivileged user, the source can be omitted, and the &kvm; user networking "
"feature will be used. Using this option requires <emphasis>dhcp-client</"
"emphasis> and <emphasis>iproute2</emphasis>, which is the case with the "
"&sls; Minimal pattern."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3607
#, no-c-format
msgid "&xen;: Moving from PV to FV"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3608
#, no-c-format
msgid ""
"This chapter explains how to convert a &xen; para-virtual machine into a "
"&xen; fully virtualized machine."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3612
#, no-c-format
msgid ""
"First you need to change to the <emphasis>-default</emphasis> kernel, if not "
"already installed, you must install it while in PV mode."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3616
#, no-c-format
msgid ""
"In case you are using <emphasis>vda*</emphasis> disk naming, you need to "
"change this to <emphasis>hd*</emphasis> in <filename>/etc/fstab</filename>, "
"<filename>/boot/grub/menu.lst</filename> and <filename>/boot/grub/device."
"map</filename>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3623
#, no-c-format
msgid "Prefer UUIDs"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3624
#, no-c-format
msgid ""
"You should use UUIDs or logical volumes within your <filename>/etc/fstab</"
"filename>. Using UUID simplifies attached network storage, multipathing, and "
"virtualization."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3630
#, no-c-format
msgid ""
"Moving from PV to FV will lead to disk driver modules being missing from the "
"initrd. The modules expected are <emphasis>xen-vbd</emphasis> (and "
"<emphasis>xen-vnif</emphasis> for network). These are the PV drivers for a "
"fully virtualized &vmguest;. All other modules like <emphasis>ata_piix</"
"emphasis>, <emphasis>ata_generic</emphasis> and <emphasis>libata</emphasis> "
"should be added automatically."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3639
#, no-c-format
msgid "Adding Modules to the initrd"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3640
#, no-c-format
msgid ""
"On &slsa; 11, you can add modules to the <emphasis>INITRD_MODULES</emphasis> "
"line in the <filename>/etc/sysconfig/kernel</filename> file, for example:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3645
#, no-c-format
msgid "INITRD_MODULES=\"xen-vbd xen-vnif\""
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3646
#, no-c-format
msgid ""
"Run <command>mkinitrd</command> to build a new initrd containing the modules."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3650
#, no-c-format
msgid ""
"On &slsa; 12, open <filename>/etc/dracut.conf.d/01-dist.conf</filename> and "
"add the modules with <literal>force-drivers</literal> by adding a line as in "
"the example below:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3655
#, no-c-format
msgid "force-drivers+=\"xen-vbd xen-vnif\""
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3656
#, no-c-format
msgid ""
"Run <command>dracut -f</command> to build a new initrd containing the "
"modules."
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3661
#, no-c-format
msgid ""
"You need to change a few parameters in the XML configuration file to "
"describe your &vmguest;:"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3665
#, no-c-format
msgid "Set the OS section to something like:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3668
#, no-c-format
msgid ""
"&lt;os&gt;\n"
"  &lt;type arch='x86_64' machine='xenfv'&gt;hvm&lt;/type&gt;\n"
"  &lt;loader&gt;/usr/lib/xen/boot/hvmloader&lt;/loader&gt;\n"
"  &lt;boot dev='hd'/&gt;\n"
"&lt;/os&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3669
#, no-c-format
msgid "In the devices section, you need to add:"
msgstr ""

#. Tag: screen
#: vt_best_practices.xml:3672
#, no-c-format
msgid "&lt;emulator&gt;/usr/lib/xen/bin/qemu-system-i386&lt;/emulator&gt;"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3673
#, no-c-format
msgid ""
"Replace the <emphasis>xen</emphasis> disk bus with <emphasis>ide</emphasis>, "
"and the <emphasis>xvda</emphasis> target device with <emphasis>hda</"
"emphasis>."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3679
#, no-c-format
msgid "guestfs-tools"
msgstr ""

#. Tag: para
#: vt_best_practices.xml:3680
#, no-c-format
msgid ""
"If you want to script this process, or work on disk images directly, you can "
"use the <link xlink:href=\"https://www.suse.com/documentation/sles-12/"
"book_virt/data/sec_guestfs_tools.html\">guestfs-tools</link> suite, as "
"numerous tools exist there to help to modify disk images."
msgstr ""

#. Tag: title
#: vt_best_practices.xml:3690
#, no-c-format
msgid "External References"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3697
#, no-c-format
msgid "Increasing memory density using KSM"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3703
#, no-c-format
msgid "linux-kvm.org KSM"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3709
#, no-c-format
msgid "KSM's kernel documentation"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3715
#, no-c-format
msgid "ksm - dynamic page sharing driver for linux v4"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3721
#, no-c-format
msgid "Memory Ballooning"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3727
#, no-c-format
msgid "libvirt virtio"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3733
#, no-c-format
msgid "CFQ's kernel documentation"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3740
#, no-c-format
msgid "Documentation for sysctl"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3746
#, no-c-format
msgid "LWN Random Number"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3752
#, no-c-format
msgid "KVM &xen; tweaks"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3759
#, no-c-format
msgid "Dr. Khoa Huynh, IBM Linux Technology Center"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3766
#, no-c-format
msgid "Kernel Parameters"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3772
#, no-c-format
msgid "Huge pages Administration (Mel Gorman)"
msgstr ""

#. Tag: link
#: vt_best_practices.xml:3779
#, no-c-format
msgid "kernel hugetlbpage"
msgstr ""
